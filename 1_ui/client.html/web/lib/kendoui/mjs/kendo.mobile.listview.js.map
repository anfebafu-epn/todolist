{"version":3,"file":"kendo.mobile.listview.js","names":["__meta__","id","name","category","description","depends","$","undefined$1","kendo","window","Node","mobile","ui","outerHeight","_outerHeight","DataSource","data","Widget","DataBoundWidget","HIGHLIGHT_SELECTOR","ICON_SELECTOR","attr","attrValue","GROUP_CLASS","GROUP_WRAPPER","GROUP_TEMPLATE","template","this","headerTemplate","render","items","SEARCH_TEMPLATE","placeholder","NS","STYLED","DATABOUND","DATABINDING","ITEM_CHANGE","CLICK","CHANGE","PROGRESS","FUNCTION","whitespaceRegExp","buttonRegExp","whitespace","nodeType","TEXT_NODE","nodeValue","match","addIcon","item","icon","querySelector","prepend","putAt","element","top","css","HeaderFixer","Class","extend","init","listView","scroller","options","_shouldFixHeaders","headerFixer","cacheHeaders","_cacheHeaders","bind","_scrollHandler","e","_fixHeader","destroy","that","unbind","fixedHeaders","headerPair","offset","header","i","headers","scrollTop","currentHeader","fixedContainer","html","clone","type","find","each","_","unshift","position","DEFAULT_PULL_PARAMETERS","page","RefreshHandler","handler","pullParameters","setDataSource","dataSource","setOptions","pullToRefresh","pull","_pulled","read","call","_first","messages","pullTemplate","releaseTemplate","refreshTemplate","view","_change","pullHandled","VirtualList","Observable","list","fn","buffer","height","footer","refresh","endReached","length","pop","prevItem","itemConstructor","idx","viewSize","total","content","below","push","itemCount","trigger","_resize","totalHeight","bottom","averageItemHeight","remainingItemsCount","batchUpdate","initialOffset","lastDirection","update","above","nextIndex","shift","firstItem","lastItem","padding","up","lastTop","topBorder","bottomBorder","index","at","VirtualListViewItem","dataItem","append","offsetHeight","setDataItem","remove","LOAD_ICON","VirtualListViewLoadingIndicator","appendTo","_loadIcon","enable","show","disable","hide","VirtualListViewPressToLoadMore","_loadButton","loadMoreText","loadMore","kendoMobileButton","_hideShowButton","next","_showLoadButton","addClass","removeClass","VirtualListViewItemBinder","binder","chromeHeight","wrapper","children","not","empty","reset","range","makeVirtual","_scroll","_scrollEnd","pageSize","pressToLoadMore","virtualViewSize","Error","Buffer","Math","floor","updateScrollerSize","updateSize","virtualSize","ListViewItemBinder","itemBinder","_refreshHandler","_progressHandler","showLoading","_unbindDataSource","removedItems","addedItems","addedDataItems","action","dataItems","prependOnRefresh","appendOnRefresh","groups","group","groupedMode","_filter","findByDataItem","_shouldShowLoading","hideLoading","replaceGrouped","replace","indexOf","insertAt","ns","_hasBindingTarget","endlessScroll","ListViewFilter","filter","filterable","events","before","autoFilter","searchInput","closest","on","preventDefault","end","_oldFilter","val","split","join","_filterChange","clearButton","_clearFilter","_dataSourceChange","_refreshInput","appliedFilters","filters","field","value","_search","expr","setTimeout","_applyFilter","operator","ignoreCase","ListView","scrollTreshold","scrollThreshold","_userEvents","UserEvents","fastTap","allowSelection","tap","_click","wrap","parent","_headerFixer","_itemsCache","_templates","virtual","_style","$angular","_start","_itemBinder","_pullToRefreshHandler","_enhanceItems","notify","style","autoBind","htmlEncode","pullOffset","emptyDataSource","create","fetch","unwrap","_scrollerInstance","loader","triggerChange","_renderItems","eq","after","_angularItems","cancel","groupTemplate","angular","elements","selectors","uid","newItem","replaceWith","_size","getSize","callback","map","_dim","_toggle","_highlight","highlight","which","clicked","currentTarget","plainItem","prevented","isDefaultPrevented","toggleClass","templateProxy","groupTemplateProxy","_headerTemplate","event","target","buttonElement","roleSelector","button","widgetInstance","getByUid","_styleGroups","rootItems","li","groupHeader","contents","first","is","grouped","inset","parents","child","enhanced","label","itemAndDetailButtons","add","enhanceLinkItem","enhanceItem","plugin","jQuery"],"sources":["kendo.mobile.listview.js"],"mappings":"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","sourcesContent":["import './kendo.data.js';\nimport './kendo.userevents.js';\nimport './kendo.mobile.button.js';\n\nvar __meta__ = {\n    id: \"mobile.listview\",\n    name: \"ListView\",\n    category: \"mobile\",\n    description: \"The Kendo Mobile ListView widget is used to display flat or grouped list of items.\",\n    depends: [ \"data\", \"userevents\", \"mobile.button\" ]\n};\n\n(function($, undefined$1) {\n    var kendo = window.kendo,\n        Node = window.Node,\n        mobile = kendo.mobile,\n        ui = mobile.ui,\n        outerHeight = kendo._outerHeight,\n        DataSource = kendo.data.DataSource,\n        Widget = ui.DataBoundWidget,\n        ITEM_SELECTOR = \".km-list > li, > li:not(.km-group-container)\",\n        HIGHLIGHT_SELECTOR = \".km-listview-link, .km-listview-label\",\n        ICON_SELECTOR = \"[\" + kendo.attr(\"icon\") + \"]\",\n        attrValue = kendo.attrValue,\n        GROUP_CLASS = \"km-group-title\",\n        ACTIVE_CLASS = \"km-state-active\",\n        GROUP_WRAPPER = `<div class=\"${GROUP_CLASS}\"><div class=\"km-text\"></div></div>`,\n        GROUP_TEMPLATE = kendo.template((data) => `<li><div class=\"${GROUP_CLASS}\"><div class=\"km-text\">${this.headerTemplate(data)}</div></div><ul>${kendo.render(this.template, data.items)}</ul></li>`),\n        WRAPPER = '<div class=\"km-listview-wrapper\"></div>',\n        SEARCH_TEMPLATE = kendo.template(({ placeholder }) => `<form class=\"km-filter-form\"><div class=\"km-filter-wrap\"><input type=\"search\" placeholder=\"${placeholder}\"/><a href=\"#\" class=\"km-filter-reset\" title=\"Clear\"><span class=\"km-icon km-clear\"></span><span class=\"km-text\">Clear</span></a></div></form>`),\n        NS = \".kendoMobileListView\",\n        STYLED = \"styled\",\n        DATABOUND = \"dataBound\",\n        DATABINDING = \"dataBinding\",\n        ITEM_CHANGE = \"itemChange\",\n        CLICK = \"click\",\n        CHANGE = \"change\",\n        PROGRESS = \"progress\",\n        FUNCTION = \"function\",\n\n        whitespaceRegExp = /^\\s+$/,\n        buttonRegExp = /button/;\n\n    function whitespace() {\n        return this.nodeType === Node.TEXT_NODE && this.nodeValue.match(whitespaceRegExp);\n    }\n\n    function addIcon(item, icon) {\n        if (icon && !item[0].querySelector(\".km-icon\")) {\n            item.prepend('<span class=\"km-icon km-' + icon + '\"/>');\n        }\n    }\n\n    function enhanceItem(item) {\n        addIcon(item, attrValue(item, \"icon\"));\n        addIcon(item, attrValue(item.children(ICON_SELECTOR), \"icon\"));\n    }\n\n    function enhanceLinkItem(item) {\n        var parent = item.parent(),\n            itemAndDetailButtons = item.add(parent.children(kendo.roleSelector(\"detailbutton\"))),\n            otherNodes = parent.contents().not(itemAndDetailButtons).not(whitespace);\n\n        if (otherNodes.length) {\n            return;\n        }\n\n        item.addClass(\"km-listview-link\")\n            .attr(kendo.attr(\"role\"), \"listview-link\");\n\n        addIcon(item, attrValue(parent, \"icon\"));\n        addIcon(item, attrValue(item, \"icon\"));\n    }\n\n    function enhanceCheckBoxItem(label) {\n        if (!label[0].querySelector(\"input[type=checkbox],input[type=radio]\")) {\n            return;\n        }\n\n        var item = label.parent();\n\n        if (item.contents().not(label).not(function() { return this.nodeType == 3; })[0]) {\n            return;\n        }\n\n        label.addClass(\"km-listview-label\");\n\n        label.children(\"[type=checkbox],[type=radio]\").addClass(\"km-widget km-icon km-check\");\n    }\n\n    function putAt(element, top) {\n        $(element).css('transform', 'translate3d(0px, ' + top + 'px, 0px)');\n    }\n\n    var HeaderFixer = kendo.Class.extend({\n        init: function(listView) {\n            var scroller = listView.scroller();\n\n            if (!scroller) {\n                return;\n            }\n\n            this.options = listView.options;\n            this.element = listView.element;\n            this.scroller = listView.scroller();\n            this._shouldFixHeaders();\n\n            var headerFixer = this;\n\n            var cacheHeaders = function() {\n                headerFixer._cacheHeaders();\n            };\n\n            listView.bind(\"resize\", cacheHeaders);\n\n            listView.bind(STYLED, cacheHeaders);\n            listView.bind(DATABOUND, cacheHeaders);\n\n            this._scrollHandler = function(e) {\n                headerFixer._fixHeader(e);\n            };\n            scroller.bind(\"scroll\", this._scrollHandler);\n        },\n\n        destroy: function() {\n            var that = this;\n            if (that.scroller) {\n                that.scroller.unbind(\"scroll\", that._scrollHandler);\n            }\n        },\n\n        _fixHeader: function(e) {\n            if (!this.fixedHeaders) {\n                return;\n            }\n\n            var i = 0,\n                scroller = this.scroller,\n                headers = this.headers,\n                scrollTop = e.scrollTop,\n                headerPair,\n                offset,\n                header;\n\n            do {\n                headerPair = headers[i++];\n                if (!headerPair) {\n                    header = $(\"<div />\");\n                    break;\n                }\n                offset = headerPair.offset;\n                header = headerPair.header;\n            } while (offset + 1 > scrollTop);\n\n            if (this.currentHeader != i) {\n                scroller.fixedContainer.html(header.clone());\n                this.currentHeader = i;\n            }\n        },\n\n        _shouldFixHeaders: function() {\n            this.fixedHeaders = this.options.type === \"group\" && this.options.fixedHeaders;\n        },\n\n        _cacheHeaders: function() {\n            this._shouldFixHeaders();\n\n            if (!this.fixedHeaders) {\n                return;\n            }\n\n            var headers = [], offset = this.scroller.scrollTop;\n\n            this.element.find(\".\" + GROUP_CLASS).each(function(_, header) {\n                header = $(header);\n                headers.unshift({\n                    offset: header.position().top + offset,\n                    header: header\n                });\n            });\n\n            this.headers = headers;\n            this._fixHeader({ scrollTop: offset });\n        }\n    });\n\n    var DEFAULT_PULL_PARAMETERS = function() {\n        return { page: 1 };\n    };\n\n    var RefreshHandler = kendo.Class.extend({\n        init: function(listView) {\n            var handler = this,\n                options = listView.options,\n                scroller = listView.scroller(),\n                pullParameters = options.pullParameters || DEFAULT_PULL_PARAMETERS;\n\n            this.listView = listView;\n            this.scroller = scroller;\n\n            listView.bind(\"_dataSource\", function(e) {\n                handler.setDataSource(e.dataSource);\n            });\n\n            scroller.setOptions({\n                pullToRefresh: true,\n                pull: function() {\n                    if (!handler._pulled) {\n                        handler._pulled = true;\n                        handler.dataSource.read(pullParameters.call(listView, handler._first));\n                    }\n                },\n                messages: {\n                    pullTemplate: options.messages.pullTemplate,\n                    releaseTemplate: options.messages.releaseTemplate,\n                    refreshTemplate: options.messages.refreshTemplate\n                }\n            });\n        },\n\n        setDataSource: function(dataSource) {\n            var handler = this;\n\n            this._first = dataSource.view()[0];\n            this.dataSource = dataSource;\n\n            dataSource.bind(\"change\", function() {\n                handler._change();\n            });\n\n            dataSource.bind(\"error\", function() {\n                handler._change();\n            });\n        },\n\n        _change: function() {\n            var scroller = this.scroller,\n                dataSource = this.dataSource;\n\n            if (this._pulled) {\n                scroller.pullHandled();\n            }\n\n            if (this._pulled || !this._first) {\n                var view = dataSource.view();\n\n                if (view[0]) {\n                    this._first = view[0];\n                }\n            }\n\n            this._pulled = false;\n        }\n    });\n\n    var VirtualList = kendo.Observable.extend({\n        init: function(options) {\n            var list = this;\n\n            kendo.Observable.fn.init.call(list);\n\n            list.buffer = options.buffer;\n            list.height = options.height;\n            list.item = options.item;\n            list.items = [];\n            list.footer = options.footer;\n\n            list.buffer.bind(\"reset\", function() {\n                list.refresh();\n            });\n\n        },\n\n        refresh: function() {\n            var buffer = this.buffer,\n                items = this.items,\n                endReached = false;\n\n            while (items.length) {\n                items.pop().destroy();\n            }\n\n            this.offset = buffer.offset;\n\n            var itemConstructor = this.item,\n                prevItem,\n                item;\n\n            for (var idx = 0; idx < buffer.viewSize; idx ++) {\n                if (idx === buffer.total()) {\n                    endReached = true;\n                    break;\n                }\n                item = itemConstructor(this.content(this.offset + items.length));\n                item.below(prevItem);\n                prevItem = item;\n                items.push(item);\n            }\n\n            this.itemCount = items.length;\n\n            this.trigger(\"reset\");\n\n            this._resize();\n\n            if (endReached) {\n                this.trigger(\"endReached\");\n            }\n        },\n\n        totalHeight: function() {\n            if (!this.items[0]) {\n                return 0;\n            }\n\n            var list = this,\n                items = list.items,\n                top = items[0].top,\n                bottom = items[items.length - 1].bottom,\n                averageItemHeight = (bottom - top) / list.itemCount,\n                remainingItemsCount = list.buffer.length - list.offset - list.itemCount;\n\n            return (this.footer ? this.footer.height : 0) + bottom + remainingItemsCount * averageItemHeight;\n        },\n\n        batchUpdate: function(top) {\n            var height = this.height(),\n                items = this.items,\n                item,\n                initialOffset = this.offset;\n\n            if (!items[0]) {\n                return;\n            }\n\n            if (this.lastDirection) { // scrolling up\n                while (items[items.length - 1].bottom > top + height * 2) {\n                    if (this.offset === 0) {\n                        break;\n                    }\n\n                    this.offset --;\n                    item = items.pop();\n                    item.update(this.content(this.offset));\n                    item.above(items[0]);\n                    items.unshift(item);\n                }\n            } else { // scrolling down\n                while (items[0].top < top - height) {\n                    var nextIndex = this.offset + this.itemCount; // here, it should be offset + 1 + itemCount - 1.\n\n                    if (nextIndex === this.buffer.total()) {\n                        this.trigger(\"endReached\");\n                        break;\n                    }\n\n                    if (nextIndex === this.buffer.length) {\n                        break;\n                    }\n\n                    item = items.shift();\n                    item.update(this.content(this.offset + this.itemCount));\n                    item.below(items[items.length - 1]);\n                    items.push(item);\n                    this.offset ++;\n                }\n            }\n\n            if (initialOffset !== this.offset) {\n                this._resize();\n            }\n        },\n\n        update: function(top) {\n            var list = this,\n                items = this.items,\n                item,\n                firstItem,\n                lastItem,\n                height = this.height(),\n                itemCount = this.itemCount,\n                padding = height / 2,\n                up = (this.lastTop || 0) > top,\n                topBorder = top - padding,\n                bottomBorder = top + height + padding;\n\n            if (!items[0]) {\n                return;\n            }\n\n            this.lastTop = top;\n            this.lastDirection = up;\n\n            if (up) { // scrolling up\n               if (items[0].top > topBorder && // needs reorder\n                   items[items.length - 1].bottom > bottomBorder + padding && // enough padding below\n                   this.offset > 0 // we are not at the top\n                  )\n               {\n                    this.offset --;\n                    item = items.pop();\n                    firstItem = items[0];\n                    item.update(this.content(this.offset));\n                    items.unshift(item);\n\n                    item.above(firstItem);\n                    list._resize();\n               }\n            } else { // scrolling down\n                if (\n                    items[items.length - 1].bottom < bottomBorder && // needs reorder\n                    items[0].top < topBorder - padding // enough padding above\n                )\n                {\n                    var nextIndex = this.offset + itemCount; // here, it should be offset + 1 + itemCount - 1.\n\n                    if (nextIndex === this.buffer.total()) {\n                        this.trigger(\"endReached\");\n                    } else if (nextIndex !== this.buffer.length) {\n                        item = items.shift();\n                        lastItem = items[items.length - 1];\n                        items.push(item);\n                        item.update(this.content(this.offset + this.itemCount));\n                        list.offset ++;\n\n                        item.below(lastItem);\n                        list._resize();\n                    }\n                }\n            }\n        },\n\n        content: function(index) {\n            return this.buffer.at(index);\n        },\n\n        destroy: function() {\n            this.unbind();\n        },\n\n        _resize: function() {\n            var items = this.items,\n                top = 0,\n                bottom = 0,\n                firstItem = items[0],\n                lastItem = items[items.length - 1];\n\n            if (firstItem) {\n                top = firstItem.top;\n                bottom = lastItem.bottom;\n            }\n\n            this.trigger(\"resize\", { top: top, bottom: bottom });\n\n            if (this.footer) {\n                this.footer.below(lastItem);\n            }\n        }\n    });\n\n    // export for testing purposes\n    kendo.mobile.ui.VirtualList = VirtualList;\n\n    var VirtualListViewItem = kendo.Class.extend({\n        init: function(listView, dataItem) {\n            var element = listView.append([dataItem], true)[0],\n                height = element.offsetHeight;\n\n            $.extend(this, {\n                top: 0,\n                element: element,\n                listView: listView,\n                height: height,\n                bottom: height\n            });\n        },\n\n        update: function(dataItem) {\n            this.element = this.listView.setDataItem(this.element, dataItem);\n        },\n\n        above: function(item) {\n            if (item) {\n                this.height = this.element.offsetHeight;\n                this.top = item.top - this.height;\n                this.bottom = item.top;\n                putAt(this.element, this.top);\n            }\n        },\n\n        below: function(item) {\n            if (item) {\n                this.height = this.element.offsetHeight;\n                this.top = item.bottom;\n                this.bottom = this.top + this.height;\n                putAt(this.element, this.top);\n            }\n        },\n\n        destroy: function() {\n            kendo.destroy(this.element);\n            $(this.element).remove();\n        }\n    });\n\n    var LOAD_ICON = '<div><span class=\"km-icon\"></span><span class=\"km-loading-left\"></span><span class=\"km-loading-right\"></span></div>';\n    var VirtualListViewLoadingIndicator = kendo.Class.extend({\n        init: function(listView) {\n            this.element = $('<li class=\"km-load-more km-scroller-refresh\" style=\"display: none\"></li>').appendTo(listView.element);\n            this._loadIcon = $(LOAD_ICON).appendTo(this.element);\n        },\n\n        enable: function() {\n            this.element.show();\n            this.height = outerHeight(this.element, true);\n        },\n\n        disable: function() {\n            this.element.hide();\n            this.height = 0;\n        },\n\n        below: function(item) {\n            if (item) {\n                this.top = item.bottom;\n                this.bottom = this.height + this.top;\n                putAt(this.element, this.top);\n            }\n        }\n    });\n\n    var VirtualListViewPressToLoadMore = VirtualListViewLoadingIndicator.extend({\n        init: function(listView, buffer) {\n\n            this._loadIcon = $(LOAD_ICON).hide();\n            this._loadButton = $('<a class=\"km-load\">' + listView.options.messages.loadMoreText + '</a>').hide();\n            this.element = $('<li class=\"km-load-more\" style=\"display: none\"></li>').append(this._loadIcon).append(this._loadButton).appendTo(listView.element);\n\n            var loadMore = this;\n\n            this._loadButton.kendoMobileButton().data(\"kendoMobileButton\").bind(\"click\", function() {\n                loadMore._hideShowButton();\n                buffer.next();\n            });\n\n            buffer.bind(\"resize\", function() {\n                loadMore._showLoadButton();\n            });\n\n            this.height = outerHeight(this.element, true);\n            this.disable();\n        },\n\n        _hideShowButton: function() {\n            this._loadButton.hide();\n            this.element.addClass(\"km-scroller-refresh\");\n            this._loadIcon.css('display', 'block');\n        },\n\n        _showLoadButton: function() {\n            this._loadButton.show();\n            this.element.removeClass(\"km-scroller-refresh\");\n            this._loadIcon.hide();\n        }\n    });\n\n    var VirtualListViewItemBinder = kendo.Class.extend({\n        init: function(listView) {\n            var binder = this;\n\n            this.chromeHeight = outerHeight(listView.wrapper.children().not(listView.element));\n            this.listView = listView;\n            this.scroller = listView.scroller();\n            this.options = listView.options;\n\n            listView.bind(\"_dataSource\", function(e) {\n                binder.setDataSource(e.dataSource, e.empty);\n            });\n\n            listView.bind(\"resize\", function() {\n                if (!binder.list.items.length) {\n                    return;\n                }\n\n                binder.scroller.reset();\n                binder.buffer.range(0);\n                binder.list.refresh();\n            });\n\n            this.scroller.makeVirtual();\n\n            this._scroll = function(e) {\n                binder.list.update(e.scrollTop);\n            };\n            this.scroller.bind('scroll', this._scroll);\n            this._scrollEnd = function(e) {\n                binder.list.batchUpdate(e.scrollTop);\n            };\n            this.scroller.bind('scrollEnd', this._scrollEnd);\n        },\n\n        destroy: function() {\n            this.list.unbind();\n            this.buffer.unbind();\n            this.scroller.unbind('scroll', this._scroll);\n            this.scroller.unbind('scrollEnd', this._scrollEnd);\n        },\n\n        setDataSource: function(dataSource, empty) {\n            var binder = this,\n                options = this.options,\n                listView = this.listView,\n                scroller = listView.scroller(),\n                pressToLoadMore = options.loadMore,\n                pageSize,\n                buffer,\n                footer;\n\n            this.dataSource = dataSource;\n\n            pageSize = dataSource.pageSize() || options.virtualViewSize;\n\n            if (!pageSize && !empty) {\n                throw new Error(\"the DataSource does not have page size configured. Page Size setting is mandatory for the mobile listview virtual scrolling to work as expected.\");\n            }\n\n            if (this.buffer) {\n                this.buffer.destroy();\n            }\n\n            buffer = new kendo.data.Buffer(dataSource, Math.floor(pageSize / 2), pressToLoadMore);\n\n            if (pressToLoadMore) {\n                footer = new VirtualListViewPressToLoadMore(listView, buffer);\n            } else {\n                footer = new VirtualListViewLoadingIndicator(listView);\n            }\n\n            if (this.list) {\n                this.list.destroy();\n            }\n\n            var list = new VirtualList({\n                buffer: buffer,\n                footer: footer,\n                item: function(dataItem) { return new VirtualListViewItem(listView, dataItem); },\n                height: function() { return scroller.height(); }\n            });\n\n            list.bind(\"resize\", function() {\n                binder.updateScrollerSize();\n                listView.updateSize();\n            });\n\n            list.bind(\"reset\", function() {\n                binder.footer.enable();\n            });\n\n            list.bind(\"endReached\", function() {\n                footer.disable();\n                binder.updateScrollerSize();\n            });\n\n            buffer.bind(\"expand\", function() {\n                list.lastDirection = false; // expand down\n                list.batchUpdate(scroller.scrollTop);\n            });\n\n            $.extend(this, {\n                buffer: buffer,\n                scroller: scroller,\n                list: list,\n                footer: footer\n            });\n        },\n\n        updateScrollerSize: function() {\n            this.scroller.virtualSize(0, this.list.totalHeight() + this.chromeHeight);\n        },\n\n        refresh: function() {\n            this.list.refresh();\n        },\n\n        reset: function() {\n            this.buffer.range(0);\n            this.list.refresh();\n        }\n    });\n\n    var ListViewItemBinder = kendo.Class.extend({\n        init: function(listView) {\n            var binder = this;\n            this.listView = listView;\n            this.options = listView.options;\n\n            var itemBinder = this;\n\n            this._refreshHandler = function(e) {\n                itemBinder.refresh(e);\n            };\n\n            this._progressHandler = function() {\n                listView.showLoading();\n            };\n\n            listView.bind(\"_dataSource\", function(e) {\n                binder.setDataSource(e.dataSource);\n            });\n        },\n\n        destroy: function() {\n            this._unbindDataSource();\n        },\n\n        reset: function() { },\n\n        refresh: function(e) {\n            var action = e && e.action,\n                dataItems = e && e.items,\n                listView = this.listView,\n                dataSource = this.dataSource,\n                prependOnRefresh = this.options.appendOnRefresh,\n                view = dataSource.view(),\n                groups = dataSource.group(),\n                groupedMode = groups && groups[0],\n                item;\n\n\n            if (action === \"itemchange\") {\n                if (!listView._hasBindingTarget()) {\n                    item = listView.findByDataItem(dataItems)[0];\n                    if (item) {\n                        listView.setDataItem(item, dataItems[0]);\n                    }\n                }\n                return;\n            }\n\n            var removedItems, addedItems, addedDataItems;\n            var adding = (action === \"add\" && !groupedMode) || (prependOnRefresh && !listView._filter);\n            var removing = action === \"remove\" && !groupedMode;\n\n            if (adding) {\n                // no need to unbind anything\n                removedItems = [];\n            } else if (removing) {\n                // unbind the items about to be removed;\n                removedItems = listView.findByDataItem(dataItems);\n            }\n\n            if (listView.trigger(DATABINDING, { action: action || \"rebind\", items: dataItems, removedItems: removedItems, index: e && e.index })) {\n                if (this._shouldShowLoading()) {\n                    listView.hideLoading();\n                }\n                return;\n            }\n\n            if (action === \"add\" && !groupedMode) {\n                var index = view.indexOf(dataItems[0]);\n                if (index > -1) {\n                    addedItems = listView.insertAt(dataItems, index);\n                    addedDataItems = dataItems;\n                }\n            } else if (action === \"remove\" && !groupedMode) {\n                addedItems = [];\n                listView.remove(dataItems);\n            } else if (groupedMode) {\n                listView.replaceGrouped(view);\n            }\n            else if (prependOnRefresh && !listView._filter) {\n                addedItems = listView.prepend(view);\n                addedDataItems = view;\n            }\n            else {\n                listView.replace(view);\n            }\n\n            if (this._shouldShowLoading()) {\n                listView.hideLoading();\n            }\n\n            listView.trigger(DATABOUND, { ns: ui, addedItems: addedItems, addedDataItems: addedDataItems });\n        },\n\n        setDataSource: function(dataSource) {\n            if (this.dataSource) {\n                this._unbindDataSource();\n            }\n\n            this.dataSource = dataSource;\n            dataSource.bind(CHANGE, this._refreshHandler);\n\n            if (this._shouldShowLoading()) {\n                this.dataSource.bind(PROGRESS, this._progressHandler);\n            }\n        },\n\n        _unbindDataSource: function() {\n            this.dataSource.unbind(CHANGE, this._refreshHandler).unbind(PROGRESS, this._progressHandler);\n        },\n\n        _shouldShowLoading: function() {\n            var options = this.options;\n            return !options.pullToRefresh && !options.loadMore && !options.endlessScroll;\n        }\n    });\n\n    var ListViewFilter = kendo.Class.extend({\n        init: function(listView) {\n            var filter = this,\n                filterable = listView.options.filterable,\n                events = \"change paste\",\n                that = this;\n\n            this.listView = listView;\n            this.options = filterable;\n\n            listView.element.before(SEARCH_TEMPLATE({ placeholder: filterable.placeholder || \"Search...\" }));\n\n            if (filterable.autoFilter !== false) {\n                events += \" keyup\";\n            }\n\n            this.element = listView.wrapper.find(\".km-search-form\");\n\n            this.searchInput = listView.wrapper.find(\"input[type=search]\")\n                .closest(\"form\").on(\"submit\" + NS, function(e) {\n                    e.preventDefault();\n                })\n                .end()\n                .on(\"focus\" + NS, function() {\n                    filter._oldFilter = filter.searchInput.val();\n                })\n                .on(events.split(\" \").join(NS + \" \") + NS, this._filterChange.bind(this));\n\n            this.clearButton = listView.wrapper.find(\".km-filter-reset\")\n                .on(CLICK, this._clearFilter.bind(this))\n                .hide();\n\n             this._dataSourceChange = this._refreshInput.bind(this);\n             listView.bind(\"_dataSource\", function(e) {\n                 e.dataSource.bind(\"change\", that._dataSourceChange);\n             });\n        },\n\n        _refreshInput: function() {\n            var appliedFilters = this.listView.dataSource.filter();\n            var searchInput = this.listView._filter.searchInput;\n\n            if (!appliedFilters || appliedFilters.filters[0].field !== this.listView.options.filterable.field) {\n                searchInput.val(\"\");\n            } else {\n                searchInput.val(appliedFilters.filters[0].value);\n            }\n        },\n\n        _search: function(expr) {\n            this._filter = true;\n            this.clearButton[expr ? \"show\" : \"hide\"]();\n            this.listView.dataSource.filter(expr);\n        },\n\n        _filterChange: function(e) {\n            var filter = this;\n            if (e.type == \"paste\" && this.options.autoFilter !== false) {\n                setTimeout(function() {\n                    filter._applyFilter();\n                }, 1);\n            } else {\n                this._applyFilter();\n            }\n        },\n\n        _applyFilter: function() {\n            var options = this.options,\n                value = this.searchInput.val(),\n                expr = value.length ? {\n                    field: options.field,\n                    operator: options.operator || \"startswith\",\n                    ignoreCase: options.ignoreCase,\n                    value: value\n                } : null;\n\n            if (value === this._oldFilter) {\n                return;\n            }\n\n            this._oldFilter = value;\n            this._search(expr);\n        },\n\n        _clearFilter: function(e) {\n            this.searchInput.val(\"\");\n            this._search(null);\n\n            e.preventDefault();\n        }\n    });\n\n    var ListView = Widget.extend({\n        init: function(element, options) {\n            var listView = this;\n\n            Widget.fn.init.call(this, element, options);\n\n            element = this.element;\n\n            options = this.options;\n\n            // support for legacy typo in configuration options: scrollTreshold -> scrollThreshold.\n            if (options.scrollTreshold) {\n                options.scrollThreshold = options.scrollTreshold;\n            }\n\n            element\n                .on(\"down\", HIGHLIGHT_SELECTOR, \"_highlight\")\n                .on(\"move up cancel\", HIGHLIGHT_SELECTOR, \"_dim\");\n\n            this._userEvents = new kendo.UserEvents(element, {\n                fastTap: true,\n                filter: ITEM_SELECTOR,\n                allowSelection: true,\n                tap: function(e) {\n                    listView._click(e);\n                }\n            });\n\n            // HACK!!! to negate the ms touch action from the user events.\n            element.css(\"-ms-touch-action\", \"auto\");\n\n            element.wrap(WRAPPER);\n\n            this.wrapper = this.element.parent();\n\n            this._headerFixer = new HeaderFixer(this);\n\n            this._itemsCache = {};\n            this._templates();\n\n            this.virtual = options.endlessScroll || options.loadMore;\n\n            this._style();\n\n            if (this.options.$angular && (this.virtual || this.options.pullToRefresh)) {\n                setTimeout(this._start.bind(this));\n            } else {\n                this._start();\n            }\n\n        },\n\n        _start: function() {\n            var options = this.options;\n\n            if (this.options.filterable) {\n                this._filter = new ListViewFilter(this);\n            }\n\n            if (this.virtual) {\n                this._itemBinder = new VirtualListViewItemBinder(this);\n            } else {\n                this._itemBinder = new ListViewItemBinder(this);\n            }\n\n            if (this.options.pullToRefresh) {\n                this._pullToRefreshHandler = new RefreshHandler(this);\n            }\n\n            this.setDataSource(options.dataSource);\n\n            this._enhanceItems(this.items());\n\n            kendo.notify(this, ui);\n        },\n\n        events: [\n            CLICK,\n            DATABINDING,\n            DATABOUND,\n            ITEM_CHANGE\n        ],\n\n        options: {\n            name: \"ListView\",\n            style: \"\",\n            type: \"flat\",\n            autoBind: true,\n            fixedHeaders: false,\n            template: (data) => kendo.htmlEncode(data),\n            headerTemplate: ({ value }) => `<span class=\"km-text\">${kendo.htmlEncode(value)}</span>`,\n            appendOnRefresh: false,\n            loadMore: false,\n            endlessScroll: false,\n            scrollThreshold: 30,\n            pullToRefresh: false,\n            messages: {\n                loadMoreText: \"Press to load more\",\n                pullTemplate: \"Pull to refresh\",\n                releaseTemplate: \"Release to refresh\",\n                refreshTemplate: \"Refreshing\"\n            },\n            pullOffset: 140,\n            filterable: false,\n            virtualViewSize: null\n        },\n\n        refresh: function() {\n            this._itemBinder.refresh();\n        },\n\n        reset: function() {\n            this._itemBinder.reset();\n        },\n\n        setDataSource: function(dataSource) {\n            // the listView should have a ready datasource for MVVM to function properly. But an empty datasource should not empty the element\n            var emptyDataSource = !dataSource;\n            this.dataSource = DataSource.create(dataSource);\n\n            this.trigger(\"_dataSource\", { dataSource: this.dataSource, empty: emptyDataSource });\n\n            if (this.options.autoBind && !emptyDataSource) {\n                this.items().remove();\n                this.dataSource.fetch();\n            }\n        },\n\n        destroy: function() {\n            Widget.fn.destroy.call(this);\n            kendo.destroy(this.element);\n            this._userEvents.destroy();\n            if (this._itemBinder) {\n                this._itemBinder.destroy();\n            }\n\n            if (this._headerFixer) {\n                this._headerFixer.destroy();\n            }\n\n            this.element.unwrap();\n            delete this.element;\n            delete this.wrapper;\n            delete this._userEvents;\n        },\n\n        items: function() {\n            if (this.options.type === \"group\") {\n                return this.element.find(\".km-list\").children();\n            } else {\n                return this.element.children().not('.km-load-more');\n            }\n        },\n\n        scroller: function() {\n            if (!this._scrollerInstance) {\n                this._scrollerInstance = this.element.closest(\".km-scroll-wrapper\").data(\"kendoMobileScroller\");\n            }\n\n            return this._scrollerInstance;\n        },\n\n        showLoading: function() {\n            var view = this.view();\n            if (view && view.loader) {\n                view.loader.show();\n            }\n        },\n\n        hideLoading: function() {\n            var view = this.view();\n            if (view && view.loader) {\n                view.loader.hide();\n            }\n        },\n\n        insertAt: function(dataItems, index, triggerChange) {\n            var listView = this;\n            return listView._renderItems(dataItems, function(items) {\n                if (index === 0) {\n                    listView.element.prepend(items);\n                }\n                else if (index === -1) {\n                    listView.element.append(items);\n                } else {\n                    listView.items().eq(index - 1).after(items);\n                }\n\n                if (triggerChange) {\n                    for (var i = 0; i < items.length; i ++) {\n                        listView.trigger(ITEM_CHANGE, { item: items.eq(i), data: dataItems[i], ns: ui });\n                    }\n                }\n            });\n        },\n\n        append: function(dataItems, triggerChange) {\n            return this.insertAt(dataItems, -1, triggerChange);\n        },\n\n        prepend: function(dataItems, triggerChange) {\n            return this.insertAt(dataItems, 0, triggerChange);\n        },\n\n        replace: function(dataItems) {\n            this.options.type = \"flat\";\n            this._angularItems(\"cleanup\");\n            kendo.destroy(this.element.children());\n            this.element.empty();\n            this._userEvents.cancel();\n            this._style();\n            return this.insertAt(dataItems, 0);\n        },\n\n        replaceGrouped: function(groups) {\n            this.options.type = \"group\";\n            this._angularItems(\"cleanup\");\n            this.element.empty();\n            var items = $(kendo.render(this.groupTemplate, groups));\n\n            this._enhanceItems(items.children(\"ul\").children(\"li\"));\n            this.element.append(items);\n            mobile.init(items);\n            this._style();\n            this._angularItems(\"compile\");\n        },\n\n        remove: function(dataItems) {\n            var items = this.findByDataItem(dataItems);\n            this.angular(\"cleanup\", function() {\n                return { elements: items };\n            });\n            kendo.destroy(items);\n            items.remove();\n        },\n\n        findByDataItem: function(dataItems) {\n            var selectors = [];\n\n            for (var idx = 0, length = dataItems.length; idx < length; idx ++) {\n                selectors[idx] = \"[data-\" + kendo.ns + \"uid=\" + dataItems[idx].uid + \"]\";\n            }\n\n            return this.element.find(selectors.join(\",\"));\n        },\n\n        // item is a DOM element, not jQuery object.\n        setDataItem: function(item, dataItem) {\n            var listView = this,\n                replaceItem = function(items) {\n                    var newItem = $(items[0]);\n                    kendo.destroy(item);\n                    listView.angular(\"cleanup\", function() { return { elements: [ $(item) ] }; });\n                    $(item).replaceWith(newItem);\n                    listView.trigger(ITEM_CHANGE, { item: newItem, data: dataItem, ns: ui });\n                };\n\n            return this._renderItems([dataItem], replaceItem)[0];\n        },\n\n        updateSize: function() {\n            this._size = this.getSize();\n        },\n\n        _renderItems: function(dataItems, callback) {\n            var items = $(kendo.render(this.template, dataItems));\n\n            callback(items);\n\n            this.angular(\"compile\", function() {\n                return {\n                    elements: items,\n                    data: dataItems.map(function(data) {\n                        return { dataItem: data };\n                    })\n                };\n            });\n\n            mobile.init(items);\n            this._enhanceItems(items);\n\n            return items;\n        },\n\n        _dim: function(e) {\n            this._toggle(e, false);\n        },\n\n        _highlight: function(e) {\n            this._toggle(e, true);\n        },\n\n        _toggle: function(e, highlight) {\n            if (e.which > 1) {\n                return;\n            }\n\n            var clicked = $(e.currentTarget),\n                item = clicked.parent(),\n                role = attrValue(clicked, \"role\") || \"\",\n                plainItem = (!role.match(buttonRegExp)),\n                prevented = e.isDefaultPrevented();\n\n            if (plainItem) {\n                item.toggleClass(ACTIVE_CLASS, highlight && !prevented);\n            }\n        },\n\n        _templates: function() {\n            var template = this.options.template,\n                headerTemplate = this.options.headerTemplate,\n                templateProxy = {},\n                groupTemplateProxy = {};\n\n            if (typeof template === FUNCTION) {\n                templateProxy.template = template;\n            } else {\n                templateProxy.template = kendo.template(template);\n            }\n\n            this.template = kendo.template((data) => `<li${data[0].uid ? ` data-uid=\"${data[0].uid}\"` : \"\"}>${this.template(data)}</li>`).bind(templateProxy);\n\n            groupTemplateProxy.template = this.template;\n\n            if (typeof headerTemplate === FUNCTION) {\n                groupTemplateProxy._headerTemplate = headerTemplate;\n            } else {\n                groupTemplateProxy._headerTemplate = kendo.template(headerTemplate);\n            }\n\n            groupTemplateProxy.headerTemplate = kendo.template((data)=> this._headerTemplate(data));\n\n            this.groupTemplate = GROUP_TEMPLATE.bind(groupTemplateProxy);\n        },\n\n        _click: function(e) {\n            if (e.event.which > 1 || e.event.isDefaultPrevented()) {\n                return;\n            }\n\n            var dataItem,\n                item = e.target,\n                target = $(e.event.target),\n                buttonElement = target.closest(kendo.roleSelector(\"button\", \"detailbutton\", \"backbutton\")),\n                button = kendo.widgetInstance(buttonElement, ui),\n                id = item.attr(kendo.attr(\"uid\"));\n\n            if (id) {\n                dataItem = this.dataSource.getByUid(id);\n            }\n\n            if (this.trigger(CLICK, { target: target, item: item, dataItem: dataItem, button: button })) {\n                e.preventDefault();\n            }\n        },\n\n        _styleGroups: function() {\n            var rootItems = this.element.children();\n\n            rootItems.children(\"ul\").addClass(\"km-list\");\n\n            rootItems.each(function() {\n                var li = $(this),\n                    groupHeader = li.contents().first();\n\n                li.addClass(\"km-group-container\");\n                if (!groupHeader.is(\"ul\") && !groupHeader.is(\"div.\" + GROUP_CLASS)) {\n                    groupHeader.wrap(GROUP_WRAPPER);\n                }\n            });\n        },\n\n        _style: function() {\n            var options = this.options,\n                grouped = options.type === \"group\",\n                element = this.element,\n                inset = options.style === \"inset\";\n\n            element.addClass(\"km-listview\")\n                .toggleClass(\"km-list\", !grouped)\n                .toggleClass(\"km-virtual-list\", this.virtual)\n                .toggleClass(\"km-listinset\", !grouped && inset)\n                .toggleClass(\"km-listgroup\", grouped && !inset)\n                .toggleClass(\"km-listgroupinset\", grouped && inset);\n\n            if (!element.parents(\".km-listview\")[0]) {\n                element.closest(\".km-content\").toggleClass(\"km-insetcontent\", inset); // iOS has white background when the list is not inset.\n            }\n\n            if (grouped) {\n                this._styleGroups();\n            }\n\n            this.trigger(STYLED);\n        },\n\n        _enhanceItems: function(items) {\n            items.each(function() {\n                var item = $(this),\n                    child,\n                    enhanced = false;\n\n                item.children().each(function() {\n                    child = $(this);\n                    if (child.is(\"a\")) {\n                        enhanceLinkItem(child);\n                        enhanced = true;\n                    } else if (child.is(\"label\")) {\n                        enhanceCheckBoxItem(child);\n                        enhanced = true;\n                    }\n                });\n\n                if (!enhanced) {\n                    enhanceItem(item);\n                }\n            });\n        }\n    });\n\n    ui.plugin(ListView);\n})(window.kendo.jQuery);\n"]}