{"version":3,"file":"kendo.orgchart.js","names":["$","undefined$1","extend","data","kendo","Query","DataSource","TreeListDataSource","Model","ObservableArray","OrgChartModel","define","id","parentId","fields","type","editable","nullable","name","validation","required","title","avatar","init","value","fn","call","this","_loaded","parentIdField","nameField","titleField","avatarField","get","accept","set","field","initiator","loaded","shouldSerialize","base","options","model","OrgChartDataSource","schema","modelBase","groupedItemsTree","map","_childrenMap","view","currentChildren","_defaultParentId","grouped","group","toArray","_innerGroupedItemsTree","itemChildren","item","fromView","itemId","filter","operator","order","_sort","length","sort","itemsTree","current","children","i","items","push","prospectParents","skippedItem","concat","read","then","_loadExpanded","bind","toggleChildren","expand","defaultPromise","Deferred","resolve","promise","_error","expanded","load","j","innerGrouped","hasChildren","_byParentId","create","Array","isArray","toJSON","Error","window","jQuery","keys","encode","htmlEncode","NS","CLICK","COLLAPSE","EXPAND","MENU","SELECT","DOT","SPACE","HASH","TABINDEX","UID","PX","PLUS","MINUS","ARIA_OWNS","ARIA_SELECTED","ORGCHART_STYLES","ROOT_TEMPLATE","label","GROUP_TEMPLATE","guid","level","NODE_GROUP_CONTAINER","result","BUTTON_TEMPLATE","buttonSign","html","renderButton","icon","CARD_TEMPLATE","color","menuLabel","fillMode","CARD_WRAPPER","uid","cssClass","GROUPED_CARD_WRAPPER","View","Observable","element","_attachEvents","events","destroy","ui","Widget","off","collapse","jqueryGroupElement","jQueryElement","_processItem","hasClass","closest","jqueryItemElement","refresh","_cacheFocused","_clearContent","_generateItemsTree","_calculateLevels","_render","select","$item","_getToSelect","previousSelection","find","removeAttr","removeClass","attr","addClass","trigger","itemsSelector","on","_onKeyDown","_onSelect","_onButtonClick","_onFocus","_onBlur","focusableItem","focusableDataItem","_dataItems","_idTabIndex","_shouldRestoreSelection","_calculateDimensions","itemElement","_selector","first","_buttonHeight","outerHeight","_spacing","_itemWidth","_calculateItemWidth","_itemHeight","_calculateLevel","empty","_dataItem","dataSource","getByUid","_groupIsVertical","_keyCollapse","_keyExpand","_keyNext","_keyPrev","_keyEnter","_keyEscape","_keyEnd","target","last","dataItems","_keyHome","e","key","keyCode","focused","isRtl","support","nextKey","LEFT","RIGHT","prevKey","expandKey","DOWN","collapseKey","UP","HOME","END","indexOf","preventDefault","stopPropagation","ENTER","ESC","that","currentTarget","shouldExpand","el","siblings","_orientation","isElement","totalWidth","_itemsTree","root","template","messages","wrapperContainer","total","_total","widgetPadding","css","append","_renderGroup","width","Number","split","_setHeight","_restoreSelection","_renderNode","cardWrapperTemplate","contentTemplate","content","cardWrapper","borderColors","cardsColors","getSeriesColors","node","attributes","JSON","parse","stringify","toFocusItem","toFocus","_getToFocus","_preventTriggerSelect","buttonHeight","selector","elements","min","MAX_VALUE","max","height","each","top","offset","bottom","SingleView","outerWidth","previousMax","itemsLength","maxColumnsPerLevel","_maxColumnsPerLevel","nestedChildren","shouldReset","container","parentUid","parentItem","dataItem","childItem","ownedGroup","next","parent","prev","vertical","vLine","before","clone","parentColumns","parentLeft","nodeContainer","_renderInner","button","innerGroup","itemWidth","spacing","buttonTemplate","numberOfColumns","hLine","_renderInnerGroup","after","left","groupTemplate","offsetDirection","GroupedView","$group","ds","_groupFocused","getAttribute","groups","currentLength","groupsLength","maxColumns","_maxGroups","currentTotal","maxGroups","groupField","some","toSelect","ownedGroupId","_renderChildren","index","nodesGroup","nodesGroupWidth","currentVertical","_renderNodesContainer","_renderItems","groupHeaderTemplate","nodeGroupContainerTemplate","nodeGroup","nodeGroupContainer","orgChart","__meta__","category","description","depends","DataBoundWidget","ContextMenu","CANCEL","CHANGE","CREATE","DATABINDING","DATABOUND","DELETE","EDIT","ERROR","PROGRESS","SAVE","REQUEST_START","MENU_ITEMS","edit","AVATAR_PREVIEW_TEMPLATE","fileName","EDITOR_BUTTONS_TEMPLATE","cancel","save","themeColor","OrgChart","_events","_wrapper","_view","_dataSource","_contextMenu","autoBind","fetch","notify","form","buttonsTemplate","orientation","destroyContent","destroyTitle","uploadAvatar","none","_menu","_editWindow","_confirmDestroy","wrapper","setDataSource","setOptions","$parent","add","sync","cancelChanges","hasChanges","delete","remove","_edit","getCollapsedNodes","saveChanges","_avatarPreview","formWrapper","_form","pop","prepend","menuElement","menuOptions","_onMenuItemClick","activate","_onMenuOpen","deactivate","_onMenuClose","showOn","animation","MENU_TEMPLATE","dsOptions","unbind","_dataSourceChangeHandler","_errorHandler","_progressHandler","_requestStartHandler","_onDataSourceChange","_onDataSourceError","_progress","_onDataSourceRequestStart","_destroyItem","confirm","Confirm","okText","show","setTimeout","open","done","fail","formElement","windowElement","formOptions","_formOptions","Form","Window","modal","close","center","validate","parentsDs","optionsItems","optionsForm","editor","editorOptions","dataValueField","dataTextField","valuePrimitive","_uploadEditor","formData","action","document","activeElement","newItem","targetItem","_openMenu","toggle","progress","_triggerCollapse","_triggerExpand","_triggerSelect","appendTo","kendoUpload","async","multiple","fileInfo","files","raw","rawFile","reader","FileReader","validationErrors","onloadend","readAsDataURL","allowedExtensions","maxFileSize","plugin"],"sources":["kendo.orgchart.js"],"mappings":"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","sourcesContent":["import './kendo.data.js';\nimport './kendo.treelist.js';\nimport './kendo.core.js';\nimport './kendo.html.button.js';\nimport './kendo.menu.js';\nimport './kendo.dialog.js';\nimport './kendo.form.js';\nimport './kendo.upload.js';\nimport './kendo.window.js';\n\n(function($, undefined$1) {\n    var extend = $.extend,\n\n        data = kendo.data,\n        Query = data.Query,\n        DataSource = data.DataSource,\n        TreeListDataSource = data.TreeListDataSource,\n        Model = data.Model,\n        ObservableArray = data.ObservableArray;\n\n    var OrgChartModel = Model.define({\n        id: \"id\",\n        parentId: \"parentId\",\n\n        fields: {\n            id: { type: \"number\", editable: false },\n            parentId: { type: \"number\", nullable: true },\n            name: { type: \"string\", validation: { required: true } },\n            title: { type: \"string\" },\n            avatar: { type: \"string\" }\n        },\n\n        init: function(value) {\n            Model.fn.init.call(this, value);\n\n            this._loaded = false;\n\n            if (!this.parentIdField) {\n                this.parentIdField = \"parentId\";\n            }\n            if (!this.nameField) {\n                this.nameField = \"name\";\n            }\n            if (!this.titleField) {\n                this.titleField = \"title\";\n            }\n            if (!this.avatarField) {\n                this.avatarField = \"avatar\";\n            }\n\n            this.parentId = this.get(this.parentIdField);\n            this.name = this.get(this.nameField);\n            this.title = this.get(this.titleField);\n            this.avatar = this.get(this.avatarField);\n        },\n\n        accept: function(data) {\n            Model.fn.accept.call(this, data);\n\n            this.parentId = this.get(this.parentIdField);\n            this.name = this.get(this.nameField);\n            this.title = this.get(this.titleField);\n            this.avatar = this.get(this.avatarField);\n        },\n\n        set: function(field, value, initiator) {\n            if (field == \"parentId\" && this.nameField != \"parentId\") {\n                this[this.parentIdField] = value;\n            }\n            if (field == \"name\" && this.nameField != \"name\") {\n                this[this.nameField] = value;\n            }\n            if (field == \"title\" && this.titleField != \"title\") {\n                this[this.titleField] = value;\n            }\n            if (field == \"avatar\" && this.avatarField != \"avatar\") {\n                this[this.avatarField] = value;\n            }\n\n            Model.fn.set.call(this, field, value, initiator);\n\n            if (field == this.parentIdField) {\n                this.parentId = this.get(this.parentIdField);\n            }\n            if (field == this.nameField) {\n                this.name = this.get(this.nameField);\n            }\n            if (field == this.titleField) {\n                this.title = this.get(this.titleField);\n            }\n            if (field == this.avatarField) {\n                this.avatar = this.get(this.avatarField);\n            }\n        },\n\n        loaded: function(value) {\n            if (value !== undefined$1) {\n                this._loaded = value;\n            } else {\n                return this._loaded;\n            }\n        },\n\n        shouldSerialize: function(field) {\n            return Model.fn.shouldSerialize.call(this, field) && field !== \"_loaded\" && field != \"_error\" && field != \"_edit\" && !(this.parentIdField !== \"parentId\" && field === \"parentId\");\n        }\n    });\n\n    OrgChartModel.parentIdField = \"parentId\";\n    OrgChartModel.nameField = \"name\";\n    OrgChartModel.titleField = \"title\";\n    OrgChartModel.avatarField = \"avatar\";\n\n    OrgChartModel.define = function(base, options) {\n        if (options === undefined$1) {\n            options = base;\n            base = OrgChartModel;\n        }\n\n        var parentId = options.parentId || \"parentId\";\n        var name = options.name || \"name\";\n        var title = options.title || \"title\";\n        var avatar = options.avatar || \"avatar\";\n\n        options.parentIdField = parentId;\n        options.nameField = name;\n        options.titleField = title;\n        options.avatarField = avatar;\n\n        var model = Model.define(base, options);\n\n        if (parentId) {\n            model.parentIdField = parentId;\n        }\n        if (name) {\n            model.nameField = name;\n        }\n        if (title) {\n            model.titleField = title;\n        }\n        if (avatar) {\n            model.avatarField = avatar;\n        }\n\n        return model;\n    };\n\n    var OrgChartDataSource = TreeListDataSource.extend({\n        init: function(options) {\n            TreeListDataSource.fn.init.call(this, extend(true, {}, {\n                schema: {\n                    modelBase: OrgChartModel,\n                    model: OrgChartModel\n                }\n            }, options));\n        },\n\n        groupedItemsTree: function(field) {\n            var map = this._childrenMap(this.view()),\n                defaultParentId = this._defaultParentId(),\n                currentChildren = map[defaultParentId] || [],\n                grouped = new Query(currentChildren).group({ field: field }).toArray();\n\n            return this._innerGroupedItemsTree(field, grouped, map);\n        },\n\n        itemChildren: function(item, fromView) {\n            var filter = {\n                field: \"parentId\",\n                operator: \"eq\",\n                value: null\n            };\n\n            var order = (this._sort && this._sort.length) ? this._sort : {};\n            var itemId, data;\n\n            if (fromView) {\n                data = this.view();\n            } else {\n                data = this.data();\n            }\n\n            if (!!item) {\n                itemId = item.get(\"id\");\n\n                if (itemId === undefined$1 || itemId === null || itemId === \"\") {\n                    return [];\n                }\n\n                filter.value = itemId;\n            }\n\n            data = new Query(data).filter(filter).sort(order).toArray();\n\n            return data;\n        },\n\n        itemsTree: function(item, field) {\n            var data = [],\n                current,\n                items = this.itemChildren(item, true),\n                children, i;\n\n            for (i = 0; i < items.length; i++) {\n                current = items[i];\n\n                if (current.get(\"expanded\")) {\n                    children = this.itemsTree(current, field);\n\n                    current = extend(true, {}, current);\n                    current.children = children;\n                }\n\n                current = extend(true, {}, current);\n                data.push(current);\n            }\n\n            if (field !== null && field !== undefined$1) {\n                data = new Query(data).group({ field: field }).toArray();\n            }\n\n            return data;\n        },\n\n        prospectParents: function(skippedItem, item) {\n            var data = [],\n                current,\n                items = this.itemChildren(item, false),\n                children, i;\n\n            for (i = 0; i < items.length; i++) {\n                current = items[i];\n\n                if (current.get(\"id\") === skippedItem.get(\"id\")) {\n                    continue;\n                }\n\n                data.push(current);\n\n                if (current.get(\"hasChildren\")) {\n                    children = this.prospectParents(skippedItem, current);\n\n                    data = data.concat(children);\n                }\n            }\n\n            return data;\n        },\n\n        read: function(data) {\n            return DataSource.fn.read.call(this, data).then(this._loadExpanded.bind(this, data));\n        },\n\n        toggleChildren: function(item, expand) {\n            var defaultPromise = $.Deferred().resolve().promise(),\n                loaded = item.loaded();\n\n            // reset error state\n            if (item._error) {\n                item.expanded = false;\n                item._error = undefined$1;\n            }\n\n            // toggle expanded state\n            if (typeof expand == \"undefined\") {\n                expand = !item.expanded;\n            }\n\n            item.expanded = expand;\n\n            if (!loaded) {\n                defaultPromise = this.load(item);\n            }\n\n            return defaultPromise;\n        },\n\n        _innerGroupedItemsTree: function(field, grouped, map) {\n            var group, i, j, itemId, innerGrouped, children, current, hasChildren;\n\n\n            for (i = 0; i < grouped.length; i++) {\n                group = grouped[i];\n                children = [];\n                hasChildren = false;\n\n                for (j = 0; j < group.items.length; j++) {\n                    current = group.items[j];\n\n                    if (!group.hasChildren && current.hasChildren) {\n                        group.hasChildren = true;\n                    }\n\n                    if (current.expanded) {\n                        group.expanded = true;\n                    }\n\n                    itemId = group.items[j].get(\"id\");\n                    children = children.concat(map[itemId]);\n                }\n\n                if (group.expanded) {\n                    innerGrouped = new Query(children).group({ field: field }).toArray();\n                    group.children = this._innerGroupedItemsTree(field, innerGrouped, map);\n                }\n\n                if (!group.hasChildren && children.length > 0) {\n                    group.hasChildren = true;\n                }\n            }\n\n            return grouped;\n        },\n\n        _loadExpanded: function(data) {\n            var items, i, current;\n\n            if (!data) {\n                return;\n            }\n\n            if (data.id !== null && data.id !== undefined$1) {\n                items = this._byParentId(data.id);\n            } else {\n                items = this._byParentId(this._defaultParentId());\n            }\n\n            for (i = 0; i < items.length; i++) {\n                current = items[i];\n\n                if (current.expanded && !current.loaded()) {\n                    this.toggleChildren(current, true);\n                }\n            }\n        }\n    });\n\n    OrgChartDataSource.create = function(options) {\n        if (Array.isArray(options)) {\n            options = { data: options };\n        } else if (options instanceof ObservableArray) {\n            options = { data: options.toJSON() };\n        }\n\n        if (!(options instanceof OrgChartDataSource) && options instanceof DataSource) {\n            throw new Error(\"Incorrect DataSource type. Only OrgChartDataSource instances are supported\");\n        }\n\n        return options instanceof OrgChartDataSource ? options : new OrgChartDataSource(options);\n    };\n\n    extend(true, kendo.data, {\n        OrgChartModel: OrgChartModel,\n        OrgChartDataSource: OrgChartDataSource\n    });\n})(window.kendo.jQuery);\n\n(function($, undefined$1) {\n    var kendo = window.kendo,\n        keys = kendo.keys,\n        encode = kendo.htmlEncode,\n        extend = $.extend,\n\n        NS = \".kendoOrgChartView\",\n\n        BLUR = \"blur\",\n        CLICK = \"click\",\n        COLLAPSE = \"collapse\",\n        EXPAND = \"expand\",\n        FOCUS = \"focus\",\n        KEYDOWN = \"keydown\",\n        MENU = \"menu\",\n        SELECT = \"select\",\n\n        DOT = \".\",\n        SPACE = \" \",\n        COMMA = \",\",\n        HASH = \"#\",\n        STRING = \"string\",\n        TABINDEX = \"tabindex\",\n        ID = \"id\",\n        UID = \"uid\",\n        PX = \"px\",\n        PLUS = \"plus\",\n        MINUS = \"minus\",\n\n        ARIA_OWNS = \"aria-owns\",\n        ARIA_SELECTED = \"aria-selected\";\n\n    var ORGCHART_STYLES = {\n        wrapper: \"k-orgchart\",\n        container: \"k-orgchart-container\",\n        line: \"k-orgchart-line\",\n        lineVertical: \"k-orgchart-line-v\",\n        lineHorizontal: \"k-orgchart-line-h\",\n        lineVerticalTop: \"k-orgchart-line-v-top\",\n        group: \"k-orgchart-group\",\n        groupVertical: \"k-orgchart-group-v\",\n        groupHorizontal: \"k-orgchart-group-h\",\n        nodesGroup: \"k-orgchart-node-group\",\n        nodesGroupContainer: \"k-orgchart-node-group-container\",\n        nodeContainer: \"k-orgchart-node-container\",\n        node: \"k-orgchart-node\",\n        card: \"k-orgchart-card\",\n        cardMenu: \"k-orgchart-card-menu\",\n        button: \"k-orgchart-button\",\n        focused: \"k-focus\",\n        plusIconSelector: \".k-i-plus,.k-svg-i-plus\",\n        menuItem: \"k-item\",\n        avatarPreview: \"k-orgchart-avatar-preview\",\n        update: \"k-orgchart-update\",\n        cancel: \"k-orgchart-cancel\",\n        vstack: \"k-vstack\",\n        hstack: \"k-hstack\"\n    };\n\n    var ROOT_TEMPLATE = ({ label }) => `<div role=\"tree\" aria-orientation=\"horizontal\" aria-label=\"${encode(label)}\" class=\"k-orgchart-group k-orgchart-level-1 k-pos-absolute k-hstack k-justify-content-center\"></div>`;\n\n    var GROUP_TEMPLATE = ({ guid, level }) => `<div role=\"group\" id=\"${encode(guid)}\" class=\"k-orgchart-level-${encode(level)} k-orgchart-group k-pos-absolute k-justify-content-around\"></div>`;\n\n    var NODE_GROUP_CONTAINER = ({ hasChildren, guid, expanded, level }) => {\n        var result = '<div role=\"treeitem\" ';\n\n        if (hasChildren && guid) {\n            result += `aria-owns=${encode(guid)} `;\n\n            if (!!expanded) {\n                result += 'aria-expanded=\"true\" ';\n            } else {\n                result += 'aria-expanded=\"false\" ';\n            }\n        }\n\n        result += `aria-keyshortcuts=\"Enter\" aria-level=\"${encode(level)}\" aria-selected=\"false\" class=\"k-orgchart-node-group-container\">`;\n\n        return result;\n    };\n\n    var NODE_CONTAINER = '<div class=\"k-orgchart-node-container k-justify-content-around\" style=\"width:100%\"></div>';\n\n    var NODE_CONTAINER_GROUPED = '<div role=\"group\" class=\"k-orgchart-node-container k-justify-content-around k-hstack\" style=\"width:100%\"></div>';\n\n    var ITEM_TEMPLATE = '<div class=\"k-orgchart-node k-vstack k-align-items-center\"></div>';\n\n    var BUTTON_TEMPLATE = ({ label, buttonSign }) => kendo.html.renderButton(`<button aria-label=\"${encode(label)}\" tabindex=\"-1\" class=\"k-orgchart-button\"></button>`, {\n        icon: encode(buttonSign)\n    });\n\n    var CARD_TEMPLATE = ({ color, avatar, name, title, editable, menuLabel }) => {\n        var result = `<div class=\"k-card-body k-hstack\" style=\"border-color:${encode(color)}\">`;\n\n        if (!!avatar) {\n            result += '<div class=\"k-avatar k-avatar-solid-primary k-avatar-solid k-avatar-lg k-rounded-full\">' +\n                '<span class=\"k-avatar-image\">' +\n                    `<img alt=\"${encode(name)}\" src=\"${encode(avatar)}\">` +\n                '</span>' +\n            '</div>';\n        }\n\n        result += '<div class=\"k-vstack k-card-title-wrap\">' +\n        `<div class=\"k-card-title k-text-ellipsis\">${encode(name)}</div>`;\n\n        if (title) {\n            result += '<span class=\"k-spacer\"></span>' +\n            `<div class=\"k-card-subtitle k-text-ellipsis\">${encode(title)}</div>`;\n        }\n\n        result += '</div>';\n\n        if (editable) {\n            result += '<span class=\"k-spacer\"></span>' +\n            '<div class=\"k-card-body-actions\">' +\n                kendo.html.renderButton(`<button class=\"k-orgchart-card-menu\" role=\"button\" aria-label=\"${encode(menuLabel)}\" tabindex=\"-1\"></button>`, {\n                    icon: 'more-vertical',\n                    fillMode: \"flat\"\n                }) +\n            '</div>';\n        }\n\n        result += '</div>';\n\n        return result;\n    };\n\n    var CARD_WRAPPER = ({ uid, guid, hasChildren, expanded, cssClass, level }) => {\n        var result = `<div role=\"treeitem\" data-uid=\"${encode(uid)}\" `;\n\n        if (hasChildren && guid) {\n            result += `aria-owns=${encode(guid)} `;\n\n            if (!!expanded) {\n                result += 'aria-expanded=\"true\" ';\n            } else {\n                result += 'aria-expanded=\"false\" ';\n            }\n        }\n\n        result += 'class=\"k-orgchart-card k-card ';\n\n        if (!!cssClass) {\n            result += `${encode(cssClass)}`;\n        }\n\n        result += `\" aria-keyshortcuts=\"Enter\" aria-level=\"${encode(level)}\" aria-selected=\"false\"></div>`;\n\n        return result;\n    };\n\n    var GROUPED_CARD_WRAPPER = ({ uid, level, cssClass }) => `<div role=\"treeitem\" data-uid=\"${encode(uid)}\" aria-level=\"${encode(level)}\" aria-selected=\"false\" aria-keyshortcuts=\"Enter\" ` +\n    'class=\"k-orgchart-card k-card ' +\n    `${cssClass ? encode(cssClass) : ''}` +\n    '\"></div>';\n\n    var View = kendo.Observable.extend({\n        init: function(element, options) {\n            this.element = element;\n            this.options = options || {};\n\n            kendo.Observable.fn.init.call(this);\n\n            this._attachEvents();\n        },\n\n        events: [\n            COLLAPSE,\n            EXPAND,\n            SELECT,\n            MENU\n        ],\n\n        destroy: function() {\n            kendo.ui.Widget.fn.destroy.call(this);\n            this.element.off(NS);\n        },\n\n        collapse: function() {\n            return false;\n        },\n\n        expand: function() {\n            return false;\n        },\n\n        jqueryGroupElement: function(group) {\n            if (!group) {\n                return;\n            }\n\n            var jQueryElement = this._processItem(group);\n\n            if (!jQueryElement.hasClass(ORGCHART_STYLES.nodesGroupContainer)) {\n                jQueryElement = jQueryElement.closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n            }\n\n            return jQueryElement && jQueryElement.length ? jQueryElement : null;\n        },\n\n        jqueryItemElement: function(item) {\n            if (!item) {\n                return;\n            }\n\n            var jQueryElement = this._processItem(item);\n\n            if (!jQueryElement.hasClass(ORGCHART_STYLES.card)) {\n                jQueryElement = jQueryElement.closest(DOT + ORGCHART_STYLES.card);\n            }\n\n            return jQueryElement && jQueryElement.length ? jQueryElement : null;\n        },\n\n        refresh: function() {\n            this._cacheFocused();\n            this._clearContent();\n            this._generateItemsTree();\n            this._calculateLevels();\n            this._render();\n        },\n\n        select: function(item) {\n            var $item = this._getToSelect(item),\n                previousSelection = this.element.find(\"[tabindex=0]\");\n\n            if (!$item) {\n                return;\n            }\n\n            previousSelection.removeAttr(TABINDEX)\n                .removeClass(ORGCHART_STYLES.focused)\n                .attr(ARIA_SELECTED, false);\n\n            $item.attr(TABINDEX, \"0\")\n                .addClass(ORGCHART_STYLES.focused)\n                .trigger(\"focus\")\n                .attr(ARIA_SELECTED, true);\n        },\n\n        _attachEvents: function() {\n            var itemsSelector = DOT + ORGCHART_STYLES.card + COMMA + DOT + ORGCHART_STYLES.nodesGroupContainer;\n\n            this.element.on(KEYDOWN + NS, itemsSelector, this._onKeyDown.bind(this))\n                .on(CLICK + NS, itemsSelector, this._onSelect.bind(this))\n                .on(CLICK + NS, DOT + ORGCHART_STYLES.button, this._onButtonClick.bind(this))\n                .on(FOCUS + NS, itemsSelector, this._onFocus.bind(this))\n                .on(BLUR + NS, DOT + ORGCHART_STYLES.focused, this._onBlur.bind(this));\n        },\n\n        _cacheFocused: function() {\n            var focusableItem = this.element.find(\"[tabindex='0']\"),\n                focusableDataItem = this._dataItems(focusableItem);\n\n            if (!focusableItem.length || !focusableDataItem || !focusableDataItem.length || !!this._idTabIndex) {\n                return;\n            }\n\n            this._idTabIndex = focusableDataItem[0].get(ID);\n\n            if (focusableItem.hasClass(ORGCHART_STYLES.focused)) {\n                this._shouldRestoreSelection = true;\n            } else {\n                this._shouldRestoreSelection = false;\n            }\n        },\n\n        _calculateDimensions: function() {\n            var itemElement = this.element.find(DOT + this._selector).first();\n\n            if (!this._buttonHeight) {\n                this._buttonHeight = this.element.find(DOT + ORGCHART_STYLES.button).first().outerHeight();\n            }\n\n            if (!this._spacing) {\n                this._spacing = this.element.find(DOT + ORGCHART_STYLES.lineVertical).first().outerHeight();\n            }\n\n            if (!this._itemWidth) {\n                this._itemWidth = this._calculateItemWidth();\n            }\n\n            if (!this._itemHeight) {\n                this._itemHeight = itemElement.outerHeight(true);\n            }\n        },\n\n        _calculateItemWidth: function() {\n            return false;\n        },\n\n        _calculateLevel: function() {\n            return false;\n        },\n\n        _calculateLevels: function() {\n            return false;\n        },\n\n        _clearContent: function() {\n            this.element.empty();\n        },\n\n        _dataItem: function(item) {\n            var $item = this.jqueryItemElement(item);\n\n            if (!$item || !$item.data(UID)) {\n                return;\n            }\n\n            return this.dataSource.getByUid($item.data(UID));\n        },\n\n        _dataItems: function() {\n            return false;\n        },\n\n        _generateItemsTree: function() {\n            return false;\n        },\n\n        _getToSelect: function() {\n            return false;\n        },\n\n        _groupIsVertical: function() {\n            return false;\n        },\n\n        _keyCollapse: function() {\n            return false;\n        },\n\n        _keyExpand: function() {\n            return false;\n        },\n\n        _keyNext: function() {\n            return false;\n        },\n\n        _keyPrev: function() {\n            return false;\n        },\n\n        _keyEnter: function() {\n            return false;\n        },\n\n        _keyEscape: function() {\n            return false;\n        },\n\n        _keyEnd: function() {\n            var target = this.element.find(DOT + ORGCHART_STYLES.card).last(),\n                previous = this.element.find(\"[tabindex=0]\");\n\n\n            if (previous[0] === target[0]) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: target,\n                dataItems: [this._dataItem(target)]\n            });\n        },\n\n        _keyHome: function() {\n            var target = this.element.find(DOT + ORGCHART_STYLES.card).first(),\n                previous = this.element.find(\"[tabindex=0]\");\n\n\n            if (previous[0] === target[0]) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: target,\n                dataItems: [this._dataItem(target)]\n            });\n        },\n\n        _onBlur: function() {\n            this.element.find(DOT + ORGCHART_STYLES.focused).removeClass(ORGCHART_STYLES.focused);\n        },\n\n        _onKeyDown: function(e) {\n            var key = e.keyCode,\n                focused = this.element.find(\"[tabindex=0]\"),\n                isRtl = kendo.support.isRtl(this.element),\n                nextKey = isRtl ? [ keys.LEFT ] : [ keys.RIGHT ],\n                prevKey = isRtl ? [ keys.RIGHT ] : [ keys.LEFT ],\n                expandKey = keys.DOWN,\n                collapseKey = keys.UP,\n                groupIsVertical;\n\n            if (!focused) {\n                return;\n            }\n\n            groupIsVertical = this._groupIsVertical(focused);\n\n            if (groupIsVertical) {\n                nextKey.push(keys.DOWN);\n                prevKey.push(keys.UP);\n            }\n\n            if (key === keys.HOME) {\n                this._keyHome();\n            } else if (key === keys.END) {\n                this._keyEnd();\n            } else if (nextKey.indexOf(key) > -1) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                this._keyNext(focused);\n            } else if (prevKey.indexOf(key) > -1) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                this._keyPrev(focused);\n            } else if (key === expandKey) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                this._keyExpand(focused);\n            } else if (key === collapseKey) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                this._keyCollapse(focused);\n            } else if (key === keys.ENTER) {\n                this._keyEnter(focused);\n            } else if (key === keys.ESC) {\n                this._keyEscape(focused);\n            }\n        },\n\n        _onButtonClick: function(e) {\n            var that = this,\n                target = $(e.currentTarget),\n                shouldExpand = target.find(ORGCHART_STYLES.plusIconSelector).length > 0 ? true : false,\n                el = target.siblings(DOT + this._selector),\n                items = this._dataItems(el),\n                i;\n\n            if (shouldExpand) {\n                if (that.trigger(EXPAND, { item: el, dataItems: items })) {\n                    return;\n                }\n            } else {\n                if (that.trigger(COLLAPSE, { item: el, dataItems: items })) {\n                    return;\n                }\n            }\n\n            for (i = 0; i < items.length; i++) {\n                that.dataSource.toggleChildren(items[i], shouldExpand).then(this.refresh.bind(this));\n            }\n        },\n\n        _onFocus: function() {\n            return false;\n        },\n\n        _onSelect: function() {\n            return false;\n        },\n\n        _orientation: function() {\n            return false;\n        },\n\n        _processItem: function(el) {\n            var jQueryElement;\n\n            // Substitute with kendo.type() when merged and taken from master\n            if ($.type(el) === STRING) {\n                jQueryElement = this.element.find(el);\n            } else if (kendo.isElement(el)) {\n                jQueryElement = $(el);\n            } else if (el instanceof jQuery) {\n                jQueryElement = el;\n            }\n\n            return jQueryElement;\n        },\n\n        _render: function() {\n            var items = this._itemsTree,\n                root = $(kendo.template(ROOT_TEMPLATE)({ label: this.options.messages.label })),\n                wrapperContainer = this.element,\n                total = this._total,\n                widgetPadding = wrapperContainer.closest(DOT + ORGCHART_STYLES.wrapper).css(\"padding-left\"),\n                totalWidth;\n\n            wrapperContainer.append(root);\n\n            this._renderGroup(root, items, 1, this._total, 0);\n            totalWidth = total * this._itemWidth + (total - 1) * this._spacing;\n            root.width(totalWidth);\n            wrapperContainer.width(totalWidth + Number(widgetPadding.split(PX)[0]));\n\n            this._setHeight();\n            this._restoreSelection();\n        },\n\n        _renderNode: function(cardWrapperTemplate, contentTemplate, item, level, guid) {\n            var messages = this.options.messages,\n                borderColors = this.options.cardsColors || kendo.getSeriesColors(),\n                node = $(ITEM_TEMPLATE),\n                content, cardWrapper;\n\n            cardWrapper = $(cardWrapperTemplate(extend(true, {}, item, {\n                menuLabel: messages.menuLabel,\n                level: level,\n                guid: guid,\n                editable: !!this.options.editable,\n                color: borderColors[level - 1] || borderColors[0]\n            })));\n\n            if (item.attributes) {\n                cardWrapper.attr(JSON.parse(JSON.stringify(item.attributes)));\n            }\n\n            content = $(contentTemplate(extend(true, {}, item, {\n                menuLabel: messages.menuLabel,\n                level: level,\n                guid: guid,\n                editable: !!this.options.editable,\n                color: borderColors[level - 1] || borderColors[0]\n            })));\n\n            cardWrapper.append(content);\n            node.append(cardWrapper);\n\n            return node;\n        },\n\n        _renderGroup: function() {\n            return false;\n        },\n\n        _restoreSelection: function() {\n            var toFocusItem, toFocus;\n\n            if (!this._idTabIndex) {\n                toFocus = this.element.find(DOT + this._selector).first();\n\n                toFocus.attr(TABINDEX, \"0\");\n            } else {\n                toFocusItem = this.dataSource.get(this._idTabIndex);\n                toFocus = toFocusItem ? this._getToFocus(toFocusItem) : this.element.find(DOT + this._selector).first();\n                toFocus.attr(TABINDEX, \"0\");\n\n                this._idTabIndex = null;\n            }\n\n            if (this._shouldRestoreSelection) {\n                this._shouldRestoreSelection = false;\n                this._preventTriggerSelect = true;\n                toFocus.trigger(\"focus\");\n                toFocus.addClass(ORGCHART_STYLES.focused);\n            }\n        },\n\n        _setHeight: function() {\n            var selector = this._selector,\n                elements = this.element.find(DOT + ORGCHART_STYLES.button + COMMA + DOT + selector),\n                min = Number.MAX_VALUE, max = 0,\n                buttonHeight;\n\n            this._calculateDimensions();\n\n            buttonHeight = this._buttonHeight;\n            this.element.find(DOT + ORGCHART_STYLES.lineVerticalTop).height(this._spacing + buttonHeight / 2);\n\n            elements.each(function(i, el) {\n                var top = $(el).offset().top,\n                    bottom = top + $(el).outerHeight(true);\n\n                if (top < min) {\n                    min = top;\n                }\n\n                if (bottom > max) {\n                    max = bottom;\n                }\n            });\n\n            this.element.height(max - min);\n        }\n    });\n\n    var SingleView = View.extend({\n        init: function(element, options) {\n            View.fn.init.call(this, element, options);\n\n            this._selector = ORGCHART_STYLES.card;\n        },\n\n        collapse: function(item) {\n            var $item = this.jqueryItemElement(item);\n\n            if (!$item) {\n                return;\n            }\n\n            this.dataSource.toggleChildren(this._dataItem($item), false).then(this.refresh.bind(this));\n        },\n\n        expand: function(item) {\n            var $item = this.jqueryItemElement(item);\n\n            if (!$item) {\n                return;\n            }\n\n            this.dataSource.toggleChildren(this._dataItem($item), true).then(this.refresh.bind(this));\n        },\n\n        _calculateItemWidth: function() {\n            return this.element.find(DOT + this._selector).first().outerWidth(true);\n        },\n\n        _calculateLevel: function(items, level) {\n            var itemsLength = items.length,\n                maxColumnsPerLevel = this._maxColumnsPerLevel,\n                nestedChildren = false,\n                shouldReset = false,\n                previousMax, i, item;\n\n            if (!maxColumnsPerLevel[level] || maxColumnsPerLevel[level] < itemsLength) {\n                previousMax = maxColumnsPerLevel[level];\n                shouldReset = true;\n                maxColumnsPerLevel[level] = itemsLength;\n            }\n\n            for (i = 0; i < itemsLength; i++) {\n                item = items[i];\n\n                if (item.hasChildren) {\n                    nestedChildren = true;\n\n                    if (item.expanded) {\n                        this._calculateLevel(item.children, level + 1);\n                    }\n                }\n            }\n\n            if (!nestedChildren && shouldReset && level > 0) {\n                shouldReset = false;\n                maxColumnsPerLevel[level] = previousMax || 1;\n            }\n        },\n\n        _calculateLevels: function() {\n            var items = this._itemsTree,\n                maxColumnsPerLevel = this._maxColumnsPerLevel = [],\n                total = 1,\n                i;\n\n            this._calculateLevel(items, 0);\n\n            for (i = 0; i < maxColumnsPerLevel.length; i++) {\n                total = total * maxColumnsPerLevel[i];\n            }\n\n            this._total = total;\n        },\n\n        _dataItems: function(container) {\n            var item = this.dataSource.getByUid(container.data(UID));\n\n            if (item) {\n                return [item];\n            } else {\n                return null;\n            }\n        },\n\n        _generateItemsTree: function() {\n            this._itemsTree = this.dataSource.itemsTree();\n        },\n\n        _getToFocus: function(item) {\n            return this.element.find(\"[data-uid='\" + item.get(UID) + \"']\");\n        },\n\n        _getToSelect: function(el) {\n            return this.jqueryItemElement(el);\n        },\n\n        _groupIsVertical: function(focused) {\n            var itemGroup = focused.closest(DOT + ORGCHART_STYLES.group);\n\n            return itemGroup.hasClass(ORGCHART_STYLES.groupVertical);\n        },\n\n        _keyCollapse: function(focused) {\n            var dataItem = this._dataItem(focused),\n                parentUid, parentItem;\n\n            if (dataItem.expanded) {\n                if (!this.trigger(COLLAPSE, { item: focused, dataItems: [dataItem] })) {\n                    this.collapse(focused);\n                }\n            } else if (dataItem.parentId) {\n                parentUid = this.dataSource.get(dataItem.parentId).get(UID);\n                parentItem = this.element.find(\"[data-uid='\" + parentUid + \"']\");\n\n                this.trigger(SELECT, {\n                    item: parentItem,\n                    dataItems: [this._dataItem(parentItem)]\n                });\n            }\n        },\n\n        _keyEnter: function(focused) {\n            if (focused.find(DOT + ORGCHART_STYLES.cardMenu).length > 0) {\n                this.trigger(MENU, focused);\n            }\n        },\n\n        _keyExpand: function(focused) {\n            var dataItem = this._dataItem(focused),\n                ownedGroup = this.element.find(HASH + focused.attr(ARIA_OWNS)),\n                childItem;\n\n            if (!dataItem.hasChildren) {\n                return;\n            }\n\n            if (!dataItem.expanded) {\n                if (!this.trigger(EXPAND, { item: focused, dataItems: [dataItem] })) {\n                    this.expand(focused);\n                }\n            } else {\n                childItem = ownedGroup.find(DOT + this._selector).first();\n\n                this.trigger(SELECT, {\n                    item: childItem,\n                    dataItems: [this._dataItem(childItem)]\n                });\n            }\n        },\n\n        _keyNext: function(focused) {\n            var dataItem = this._dataItem(focused),\n                next = focused.parent().next(DOT + ORGCHART_STYLES.node).find(DOT + ORGCHART_STYLES.card),\n                ownedGroup = this.element.find(HASH + focused.attr(ARIA_OWNS));\n\n            if (!next.length && dataItem.hasChildren && dataItem.expanded) {\n                next = ownedGroup.find(DOT + ORGCHART_STYLES.card).first();\n            }\n\n            if (next.length === 0 || next.hasClass(ORGCHART_STYLES.focused)) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: next,\n                dataItems: [this._dataItem(next)]\n            });\n        },\n\n        _keyPrev: function(focused) {\n            var dataItem = this._dataItem(focused),\n                prev = focused.parent().prev(DOT + ORGCHART_STYLES.node).find(DOT + ORGCHART_STYLES.card),\n                parentUid;\n\n            if (!prev.length && dataItem.parentId) {\n                parentUid = this.dataSource.get(dataItem.parentId).get(UID);\n                prev = this.element.find(\"[data-uid='\" + parentUid + \"']\");\n            }\n\n            if (prev.length === 0 || prev.hasClass(ORGCHART_STYLES.focused)) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: prev,\n                dataItems: [this._dataItem(prev)]\n            });\n        },\n\n        _onFocus: function(e) {\n            var currentTarget = $(e.currentTarget),\n                target = $(e.target);\n\n            if (this._preventTriggerSelect) {\n                e.stopPropagation();\n                this._preventTriggerSelect = false;\n                return;\n            }\n\n            if (target.hasClass(ORGCHART_STYLES.cardMenu)) {\n                if (target.closest(\"[tabindex='0']\").length > 0) {\n                    e.stopPropagation();\n                    return;\n                } else {\n                    this._preventTriggerSelect = true;\n                }\n            }\n\n            if (!currentTarget.hasClass(ORGCHART_STYLES.card)) {\n                currentTarget = currentTarget.closest(DOT + ORGCHART_STYLES.card);\n            }\n\n            if (!currentTarget.hasClass(ORGCHART_STYLES.focused)) {\n                this.trigger(SELECT, {\n                    item: currentTarget,\n                    dataItems: [this._dataItem(currentTarget)]\n                });\n            }\n        },\n\n        _onSelect: function(e) {\n            var target = $(e.currentTarget),\n                item = target.hasClass(ORGCHART_STYLES.card) ? target : target.closest(DOT + ORGCHART_STYLES.card),\n                menuButtonTarget = $(e.target).hasClass(ORGCHART_STYLES.cardMenu) ? $(e.target) : $(e.target).closest(DOT + ORGCHART_STYLES.cardMenu);\n\n            if (menuButtonTarget.length > 0) {\n                return;\n            }\n\n            if (!target.hasClass(ORGCHART_STYLES.focused)) {\n                this.trigger(SELECT, {\n                    item: item,\n                    dataItems: [this._dataItem(item)]\n                });\n            }\n        },\n\n        _orientation: function(group, level, vertical) {\n            var vLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineVertical);\n\n            if (vertical && level > 1) {\n                group.addClass(ORGCHART_STYLES.groupVertical + SPACE + ORGCHART_STYLES.vstack);\n                group.find(DOT + ORGCHART_STYLES.nodeContainer).addClass(ORGCHART_STYLES.vstack);\n\n                if (group.find(DOT + ORGCHART_STYLES.button).length === 0 || group.find(DOT + ORGCHART_STYLES.card).length === 1) {\n                    group.find(DOT + ORGCHART_STYLES.card).before(vLine.clone());\n                    group.find(DOT + ORGCHART_STYLES.node).first().find(DOT + ORGCHART_STYLES.lineVertical).addClass(ORGCHART_STYLES.lineVerticalTop);\n                } else if (level > 1) {\n                    group.find(DOT + ORGCHART_STYLES.card).first().before(vLine.clone());\n                }\n            } else {\n                group.addClass(ORGCHART_STYLES.groupHorizontal + SPACE + ORGCHART_STYLES.hstack);\n                group.find(DOT + ORGCHART_STYLES.nodeContainer).addClass(ORGCHART_STYLES.hstack);\n\n                if (level > 1) {\n                    group.find(DOT + ORGCHART_STYLES.card).before(vLine.clone().addClass(ORGCHART_STYLES.lineVerticalTop));\n                }\n            }\n        },\n\n        _renderGroup: function(group, items, level, parentColumns, parentLeft) {\n            var vertical = true,\n                nodeContainer;\n\n                nodeContainer = $(NODE_CONTAINER);\n                group.append(nodeContainer);\n                vertical = this._renderInner(nodeContainer, items, level, parentColumns, parentLeft);\n\n                this._orientation(group, level, vertical);\n        },\n\n        _renderInner: function(nodeContainer, items, level, parentColumns, parentLeft) {\n            var buttonTemplate = kendo.template(BUTTON_TEMPLATE),\n                cardWrapperTemplate = kendo.template(CARD_WRAPPER),\n                numberOfColumns = parentColumns / items.length,\n                vertical = true,\n                vLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineVertical),\n                hLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineHorizontal),\n                messages = this.options.messages,\n                i, item, guid, node, button, innerGroup, itemWidth, spacing, contentTemplate;\n\n            if (!this.options.template) {\n                contentTemplate = kendo.template(CARD_TEMPLATE);\n            } else if (typeof this.options.template === \"function\") {\n                contentTemplate = this.options.template;\n            } else {\n                contentTemplate = kendo.template(this.options.template);\n            }\n\n            for (i = 0; i < items.length; i++) {\n                item = items[i];\n                guid = kendo.guid();\n\n                node = this._renderNode(cardWrapperTemplate, contentTemplate, item, level, guid);\n\n                if (item.hasChildren) {\n                    node.append(vLine.clone());\n                    button = $(buttonTemplate({ buttonSign: item.expanded ? MINUS : PLUS, label: item.expanded ? messages.collapse : messages.expand }));\n                    node.append(button);\n                }\n\n                nodeContainer.append(node);\n\n                this._calculateDimensions();\n\n                itemWidth = this._itemWidth;\n                spacing = this._spacing;\n\n                if (item.hasChildren) {\n                    vertical = false;\n\n                    if (item.expanded) {\n                        innerGroup = this._renderInnerGroup(item, numberOfColumns, parentLeft, i, level, guid);\n                    }\n                }\n\n                if (!!innerGroup && innerGroup.hasClass(ORGCHART_STYLES.groupHorizontal) && item.expanded && !!item.children && item.children.length > 1) {\n                    button.after(hLine.clone().css({\n                        width: (numberOfColumns - numberOfColumns / item.children.length) * (itemWidth + spacing) + PX,\n                        \"margin-top\": this._buttonHeight / -2 + PX\n                    }));\n                }\n            }\n\n            if (numberOfColumns > 1 && !vertical) {\n                nodeContainer.find(DOT + ORGCHART_STYLES.node).width((numberOfColumns - 1) * (spacing + itemWidth));\n            }\n\n            return vertical;\n        },\n\n        _renderInnerGroup: function(item, numberOfColumns, parentLeft, i, level, guid) {\n            var itemWidth = this._itemWidth,\n                spacing = this._spacing,\n                width = numberOfColumns * itemWidth + (numberOfColumns - 1) * spacing,\n                left = (i * numberOfColumns * itemWidth) + parentLeft,\n                groupTemplate = kendo.template(GROUP_TEMPLATE),\n                offsetDirection = kendo.support.isRtl(this.element) ? \"right\" : \"left\",\n                top = level * (this._itemHeight + this._buttonHeight + spacing) + spacing * (level - 1) - this._buttonHeight / 2,\n                innerGroup;\n\n            if (i > 0) {\n                left += (i * numberOfColumns * spacing);\n            }\n\n            innerGroup = $(groupTemplate({\n                guid: guid,\n                level: level + 1\n            }));\n\n            innerGroup.css({\n                width: width + PX,\n                top: top + PX\n            });\n\n            innerGroup.css(offsetDirection, left + PX);\n\n            this.element.append(innerGroup);\n            this._renderGroup(innerGroup, item.children, level + 1, numberOfColumns, left);\n\n            return innerGroup;\n        }\n    });\n\n    var GroupedView = View.extend({\n        init: function(element, options) {\n            View.fn.init.call(this, element, options);\n\n            this._selector = ORGCHART_STYLES.nodesGroupContainer;\n        },\n\n        collapse: function(group) {\n            var $group = this.jqueryGroupElement(group),\n                dataItems, i;\n\n            if (!$group) {\n                return;\n            }\n\n            dataItems = this._dataItems($group);\n\n            for (i = 0; i < dataItems.length; i++) {\n                this.dataSource.toggleChildren(dataItems[i], false).then(this.refresh.bind(this));\n            }\n        },\n\n        expand: function(group) {\n            var $group = this.jqueryGroupElement(group),\n                dataItems, i;\n\n            if (!$group) {\n                return;\n            }\n\n            dataItems = this._dataItems($group);\n\n            for (i = 0; i < dataItems.length; i++) {\n                this.dataSource.toggleChildren(dataItems[i], true).then(this.refresh.bind(this));\n            }\n        },\n\n        _dataItems: function(container) {\n            var ds = this.dataSource,\n                dataItems = [],\n                items, item, current;\n\n            if (container.hasClass(ORGCHART_STYLES.card)) {\n                item = ds.getByUid(container.data(UID));\n\n                if (item) {\n                    dataItems.push(item);\n                }\n            } else if (container.hasClass(ORGCHART_STYLES.nodesGroupContainer)) {\n                this._groupFocused = true;\n\n                items = container.find(DOT + ORGCHART_STYLES.card);\n\n                items.each(function(i, item) {\n                    current = ds.getByUid(item.getAttribute(\"data-uid\"));\n\n                    if (current) {\n                        dataItems.push(current);\n                    }\n                });\n            }\n\n            return dataItems;\n        },\n\n        _calculateItemWidth: function() {\n            var itemElement = this.element.find(DOT + this._selector).first(),\n                cardWidth = this.element.find(DOT + ORGCHART_STYLES.card).first().outerWidth(true),\n                padding = Number(itemElement.css(\"padding-left\").split(PX)[0]),\n                border = Number(itemElement.css(\"border-left\").split(PX)[0]);\n\n            return cardWidth + 2 * padding + 2 * border;\n        },\n\n        _calculateLevel: function(groups, level) {\n            var groupsLength = groups.length,\n                nestedChildren = false,\n                maxColumns = 0,\n                currentLength, i, group;\n\n            this._maxColumnsPerLevel[level] = this._maxColumnsPerLevel[level] || 0;\n            this._maxGroups[level] = this._maxGroups[level] || 0;\n\n            for (i = 0; i < groupsLength; i++) {\n                group = groups[i];\n                currentLength = group.items.length;\n\n                if (currentLength > maxColumns) {\n                    maxColumns = currentLength;\n                }\n\n                group = groups[i];\n\n                if (group.hasChildren) {\n                    nestedChildren = true;\n\n                    if (group.expanded) {\n                        this._calculateLevel(group.children, level + 1);\n                    }\n                }\n            }\n\n            if (groupsLength > this._maxGroups[level]) {\n                this._maxGroups[level] = groupsLength;\n            }\n\n            if (!nestedChildren) {\n                maxColumns = 1;\n            }\n\n            if (maxColumns > this._maxColumnsPerLevel[level]) {\n                this._maxColumnsPerLevel[level] = maxColumns;\n            }\n        },\n\n        _calculateLevels: function() {\n            var items = this._itemsTree,\n                maxColumnsPerLevel = this._maxColumnsPerLevel = [],\n                maxGroups = this._maxGroups = [],\n                total = 1,\n                i, currentTotal;\n\n            this._calculateLevel(items, 0);\n\n            for (i = maxColumnsPerLevel.length - 1; i >= 0; i--) {\n                currentTotal = maxColumnsPerLevel[i] * maxGroups[i];\n\n                if (total > maxColumnsPerLevel[i]) {\n                    total = total * maxGroups[i];\n                } else if (total < currentTotal) {\n                    total = currentTotal;\n                }\n            }\n\n            this._total = total;\n        },\n\n        _generateItemsTree: function() {\n            this._itemsTree = this.dataSource.groupedItemsTree(this.options.groupField);\n        },\n\n        _getToFocus: function(item) {\n            if (!this._groupFocused) {\n                return this.element.find(\"[data-uid='\" + item.get(UID) + \"']\");\n            } else {\n                this._groupFocused = false;\n                return this.element.find(\"[data-uid='\" + item.get(UID) + \"']\").closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n            }\n        },\n\n        _getToSelect: function(el) {\n            var item = this.jqueryItemElement(el);\n\n            return item || this.jqueryGroupElement(el);\n        },\n\n        _groupIsVertical: function(focused) {\n            var itemGroup = focused.closest(DOT + ORGCHART_STYLES.nodeContainer);\n\n            return itemGroup.hasClass(ORGCHART_STYLES.vstack);\n        },\n\n        _keyCollapse: function(focused) {\n            var dataItems = [],\n                parentUid, expanded;\n\n            dataItems = this._dataItems(focused);\n\n            expanded = dataItems.some(function(item) {\n                return item.expanded;\n            });\n\n            if (expanded) {\n                if (focused.hasClass(ORGCHART_STYLES.card)) {\n                    focused = focused.closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n                    dataItems = this._dataItems(focused);\n                }\n\n                if (!this.trigger(COLLAPSE, { item: focused, dataItems: dataItems })) {\n                    this.collapse(focused);\n                }\n            } else if (dataItems[0].parentId) {\n                parentUid = this.dataSource.get(dataItems[0].parentId).get(UID);\n\n                this.trigger(SELECT, {\n                    item: this.element.find(\"[data-uid='\" + parentUid + \"']\").closest(DOT + this._selector),\n                    dataItems: dataItems\n                });\n            }\n        },\n\n        _keyEnter: function(focused) {\n            var toSelect,\n                dataItems = [];\n\n            if (focused.hasClass(ORGCHART_STYLES.card) && focused.find(DOT + ORGCHART_STYLES.cardMenu).length > 0) {\n                this.trigger(MENU, focused);\n            } else {\n                toSelect = focused.find(DOT + ORGCHART_STYLES.card).first();\n                dataItems = this._dataItems(toSelect);\n\n                this.trigger(SELECT, {\n                    item: toSelect,\n                    dataItems: dataItems\n                });\n            }\n        },\n\n        _keyEscape: function(focused) {\n            if (!focused.hasClass(ORGCHART_STYLES.card)) {\n                return;\n            }\n\n            var group = focused.closest(DOT + ORGCHART_STYLES.nodesGroupContainer),\n                dataItems = this._dataItems(group);\n\n            this.trigger(SELECT, {\n                item: group,\n                dataItems: dataItems\n            });\n        },\n\n        _keyExpand: function(focused) {\n            var ownedGroupId = focused.attr(ARIA_OWNS) || focused.closest(DOT + this._selector).attr(ARIA_OWNS),\n                ownedGroup = this.element.find(HASH + ownedGroupId),\n                dataItems = this._dataItems(focused),\n                hasChildren, expanded, item;\n\n            hasChildren = dataItems.some(function(item) {\n                return item.hasChildren;\n            });\n\n            if (!hasChildren) {\n                return;\n            }\n\n            expanded = dataItems.some(function(item) {\n                return item.expanded;\n            });\n\n            if (!expanded) {\n                if (focused.hasClass(ORGCHART_STYLES.card)) {\n                    focused = focused.closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n                    dataItems = this._dataItems(focused);\n                }\n\n                if (!this.trigger(EXPAND, { item: focused, dataItems: dataItems })) {\n                    this.expand(focused);\n                }\n            } else {\n                item = ownedGroup.find(DOT + this._selector).first();\n\n                this.trigger(SELECT, {\n                    item: item,\n                    dataItems: this._dataItems(item)\n                });\n            }\n        },\n\n        _keyNext: function(focused) {\n            var ownedGroup = this.element.find(HASH + focused.attr(ARIA_OWNS)),\n                dataItems = this._dataItems(focused),\n                hasChildren = dataItems.some(function(item) {\n                    return item.hasChildren;\n                }),\n                expanded = dataItems.some(function(item) {\n                    return item.expanded;\n                }),\n                next;\n\n                if (focused.hasClass(ORGCHART_STYLES.card)) {\n                    next = focused.parent().next(DOT + ORGCHART_STYLES.node).find(DOT + ORGCHART_STYLES.card);\n                } else {\n                    next = focused.parent().next(DOT + ORGCHART_STYLES.nodesGroup).find(DOT + ORGCHART_STYLES.nodesGroupContainer);\n                }\n\n            if (!next.length && hasChildren && expanded) {\n                next = ownedGroup.find(DOT + this._selector).first();\n            }\n\n            if (next.length === 0) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: next,\n                dataItems: this._dataItems(next)\n            });\n        },\n\n        _keyPrev: function(focused) {\n            var dataItems = this._dataItems(focused),\n                parentUid, prev;\n\n            if (focused.hasClass(ORGCHART_STYLES.card)) {\n                prev = focused.parent().prev(DOT + ORGCHART_STYLES.node).find(DOT + ORGCHART_STYLES.card);\n            } else {\n                prev = focused.parent().prev(DOT + ORGCHART_STYLES.nodesGroup).find(DOT + ORGCHART_STYLES.nodesGroupContainer);\n            }\n\n            if (!prev.length && dataItems[0].parentId) {\n                parentUid = this.dataSource.get(dataItems[0].parentId).get(UID);\n                prev = this.element.find(\"[data-uid='\" + parentUid + \"']\").closest(DOT + this._selector);\n            }\n\n            if (prev.length === 0) {\n                return;\n            }\n\n            this.trigger(SELECT, {\n                item: prev,\n                dataItems: this._dataItems(prev)\n            });\n        },\n\n        _onFocus: function(e) {\n            var target = $(e.target),\n                items, current;\n\n            if (this._preventTriggerSelect) {\n                e.stopPropagation();\n                this._preventTriggerSelect = false;\n                return;\n            }\n\n            if (target.hasClass(ORGCHART_STYLES.cardMenu)) {\n                if (target.closest(\"[tabindex='0']\").length > 0) {\n                    e.stopPropagation();\n                    return;\n                } else {\n                    this._preventTriggerSelect = true;\n                }\n            }\n\n            if (!target.hasClass(ORGCHART_STYLES.card) && !target.hasClass(ORGCHART_STYLES.nodesGroupContainer)) {\n                current = target.closest(DOT + ORGCHART_STYLES.card);\n\n                if (!current.length) {\n                    current = target.closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n                }\n\n                target = current;\n            }\n\n            if (target.length === 0) {\n                return;\n            }\n\n            items = this._dataItems(target);\n\n            if (!target.hasClass(ORGCHART_STYLES.focused)) {\n                e.stopPropagation();\n                this.trigger(SELECT, {\n                    item: target,\n                    dataItems: items\n                });\n            }\n        },\n\n        _onSelect: function(e) {\n            var target = $(e.target),\n                previousSelection = this.element.find(\"[tabindex=0]\"),\n                items, current;\n\n            if (!target.hasClass(ORGCHART_STYLES.card) && !target.hasClass(ORGCHART_STYLES.nodesGroupContainer)) {\n                current = target.closest(DOT + ORGCHART_STYLES.card);\n\n                if (!current.length) {\n                    current = target.closest(DOT + ORGCHART_STYLES.nodesGroupContainer);\n                }\n\n                target = current;\n            }\n\n            if (target.length === 0 || previousSelection[0] === target[0]) {\n                return;\n            }\n\n            items = this._dataItems(target);\n\n            this.trigger(SELECT, {\n                item: target,\n                dataItems: items\n            });\n        },\n\n        _orientation: function(group, level, vertical) {\n            var vLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineVertical + SPACE + ORGCHART_STYLES.lineVerticalTop);\n\n            group.addClass(ORGCHART_STYLES.hstack);\n\n            if (level > 1) {\n                group.find(DOT + ORGCHART_STYLES.nodesGroupContainer).before(vLine.clone());\n            }\n\n            if (vertical && level > 1) {\n                group.find(DOT + ORGCHART_STYLES.nodeContainer).removeClass(ORGCHART_STYLES.hstack);\n                group.find(DOT + ORGCHART_STYLES.nodeContainer).addClass(ORGCHART_STYLES.vstack);\n            } else {\n                group.addClass(ORGCHART_STYLES.groupHorizontal);\n            }\n        },\n\n        _renderChildren: function(item, index, numberOfColumns, level, nodesGroup, parentLeft, guid) {\n            var buttonTemplate = kendo.template(BUTTON_TEMPLATE),\n                groupTemplate = kendo.template(GROUP_TEMPLATE),\n                vLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineVertical),\n                hLine = $(\"<div>\").addClass(ORGCHART_STYLES.line + SPACE + ORGCHART_STYLES.lineHorizontal),\n                messages = this.options.messages,\n                vertical = true,\n                offsetDirection = kendo.support.isRtl(this.element) ? \"right\" : \"left\",\n                innerGroup, button, left, top, width, nodesGroupWidth, spacing;\n\n            if (item.hasChildren) {\n                vertical = false;\n                nodesGroup.append(vLine.clone());\n                button = $(buttonTemplate({ buttonSign: item.expanded ? MINUS : PLUS, label: item.expanded ? messages.collapse : messages.expand }));\n\n                nodesGroup.append(button);\n\n                this._calculateDimensions();\n\n                nodesGroupWidth = this._itemWidth;\n                spacing = this._spacing;\n\n                if (item.expanded) {\n                    width = nodesGroupWidth * numberOfColumns + (numberOfColumns - 1) * spacing;\n                    left = (index * numberOfColumns * nodesGroupWidth) + parentLeft;\n                    top = level * (this._itemHeight + this._buttonHeight + spacing) + spacing * (level - 1) - this._buttonHeight / 2;\n\n                    if (index > 0) {\n                        left += (index * numberOfColumns * spacing);\n                    }\n\n                    innerGroup = $(groupTemplate({\n                        guid: guid,\n                        level: level + 1\n                    }));\n\n                    innerGroup.css({\n                        width: width + PX,\n                        top: top + PX\n                    });\n\n                    innerGroup.css(offsetDirection, left + PX);\n\n                    this.element.append(innerGroup);\n                    this._renderGroup(innerGroup, item.children, level + 1, numberOfColumns, left);\n                }\n            }\n\n            if (!!innerGroup && item.expanded && !!item.children && item.children.length > 1) {\n                button.after(hLine.clone().css({\n                    width: (numberOfColumns - numberOfColumns / item.children.length) * (nodesGroupWidth + spacing) + PX,\n                    \"margin-top\": this._buttonHeight / -2 + PX\n                }));\n            }\n\n            return vertical;\n        },\n\n        _renderGroup: function(group, items, level, parentColumns, parentLeft) {\n            var vertical = true,\n                numberOfColumns = parentColumns / items.length,\n                nodeContainer, nodesGroup, i, guid, currentVertical, item;\n\n            for (i = 0; i < items.length; i++) {\n                guid = kendo.guid();\n                item = items[i];\n                nodeContainer = this._renderNodesContainer(group, extend(true, {}, item, {\n                    guid: guid,\n                    level: level\n                }));\n                nodesGroup = nodeContainer.closest(DOT + ORGCHART_STYLES.nodesGroup);\n\n                this._renderItems(nodeContainer, item.items, level, guid);\n                currentVertical = this._renderChildren(item, i, numberOfColumns, level, nodesGroup, parentLeft, guid);\n\n                if (vertical) {\n                    vertical = currentVertical;\n                }\n            }\n\n            var width = this._itemWidth * numberOfColumns + (numberOfColumns - 1) * this._spacing;\n            group.find(DOT + ORGCHART_STYLES.nodesGroup).width(width);\n\n            this._orientation(group, level, vertical);\n        },\n\n        _renderItems: function(nodeContainer, items, level, guid) {\n            var cardWrapperTemplate = kendo.template(GROUPED_CARD_WRAPPER),\n                i, item, node, contentTemplate;\n\n            if (!this.options.template) {\n                contentTemplate = kendo.template(CARD_TEMPLATE);\n            } else if (typeof this.options.template === \"function\") {\n                contentTemplate = this.options.template;\n            } else {\n                contentTemplate = kendo.template(this.options.template);\n            }\n\n            for (i = 0; i < items.length; i++) {\n                item = items[i];\n                node = this._renderNode(cardWrapperTemplate, contentTemplate, item, level, guid);\n                nodeContainer.append(node);\n            }\n        },\n\n        _renderNodesContainer: function(group, data) {\n            var nodeGroupContainerTemplate = kendo.template(NODE_GROUP_CONTAINER),\n                nodeGroup = $('<div class=\"k-orgchart-node-group k-align-items-center k-vstack\">'),\n                nodeContainer = $(NODE_CONTAINER_GROUPED),\n                nodeGroupContainer = $(nodeGroupContainerTemplate(data)),\n                groupHeaderTemplate;\n\n                if (typeof this.options.groupHeaderTemplate === \"function\") {\n                    groupHeaderTemplate = this.options.groupHeaderTemplate;\n                } else {\n                    groupHeaderTemplate = kendo.template(this.options.groupHeaderTemplate);\n                }\n\n            nodeGroupContainer.append(groupHeaderTemplate({\n                value: data.value,\n                field: data.field\n            }));\n            nodeGroupContainer.append(nodeContainer);\n\n            nodeGroup.append(nodeGroupContainer);\n            group.append(nodeGroup);\n\n            return nodeContainer;\n        }\n    });\n\n    kendo.orgChart = {\n        View: View,\n        SingleView: SingleView,\n        GroupedView: GroupedView\n    };\n})(window.kendo.jQuery);\n\nvar __meta__ = {\n    id: \"orgchart\",\n    name: \"OrgChart\",\n    category: \"web\",\n    description: \"The OrgChart widget displays hierarchical organizational structure.\",\n    depends: [ \"core\", \"menu\", \"dialog\", \"form\", \"upload\", \"window\", \"data\", \"treelist\", \"html.button\" ]\n};\n\n(function($, undefined$1) {\n    var kendo = window.kendo,\n        encode = kendo.htmlEncode,\n        DataBoundWidget = kendo.ui.DataBoundWidget,\n        OrgChartDataSource = kendo.data.OrgChartDataSource,\n        ContextMenu = kendo.ui.ContextMenu,\n\n        extend = $.extend,\n        isArray = Array.isArray,\n\n        NS = \".kendoOrgChart\",\n\n        CANCEL = \"cancel\",\n        CHANGE = \"change\",\n        CLICK = \"click\",\n        COLLAPSE = \"collapse\",\n        CREATE = \"create\",\n        DATABINDING = \"dataBinding\",\n        DATABOUND = \"dataBound\",\n        DELETE = \"delete\",\n        DESTROY = \"destroy\",\n        EDIT = \"edit\",\n        ERROR = \"error\",\n        EXPAND = \"expand\",\n        FOCUS = \"focus\",\n        KENDOKEYDOWN = \"kendoKeydown\",\n        MENU = \"menu\",\n        PROGRESS = \"progress\",\n        SAVE = \"save\",\n        SELECT = \"select\",\n        REQUEST_START = \"requestStart\",\n\n        DOT = \".\",\n        SPACE = \" \",\n        COMMA = \",\",\n        ID = \"id\",\n        UID = \"uid\",\n        ACTION = \"action\";\n\n    var ORGCHART_STYLES = {\n        wrapper: \"k-orgchart\",\n        container: \"k-orgchart-container\",\n        line: \"k-orgchart-line\",\n        lineVertical: \"k-orgchart-line-v\",\n        lineHorizontal: \"k-orgchart-line-h\",\n        lineVerticalTop: \"k-orgchart-line-v-top\",\n        group: \"k-orgchart-group\",\n        groupVertical: \"k-orgchart-group-v\",\n        groupHorizontal: \"k-orgchart-group-h\",\n        nodesGroup: \"k-orgchart-node-group\",\n        nodesGroupContainer: \"k-orgchart-node-group-container\",\n        nodeContainer: \"k-orgchart-node-container\",\n        node: \"k-orgchart-node\",\n        card: \"k-orgchart-card\",\n        cardMenu: \"k-orgchart-card-menu\",\n        button: \"k-orgchart-button\",\n        focused: \"k-focus\",\n        plusIcon: \"plus\",\n        menuItem: \"k-item\",\n        avatarPreview: \"k-orgchart-avatar-preview\",\n        update: \"k-orgchart-update\",\n        cancel: \"k-orgchart-cancel\",\n        vstack: \"k-vstack\",\n        hstack: \"k-hstack\",\n        closeButton: \"x\"\n    };\n\n    var MENU_ITEMS = {\n        edit: ({ edit }) => `<li data-action='edit'>${encode(edit)}</li>`,\n        create: ({ create }) => `<li data-action='create'>${encode(create)}</li>`,\n        destroy: ({ destroy }) => `<li data-action='destroy'>${encode(destroy)}</li>`\n    };\n\n    var MENU_TEMPLATE = (messages, editable) => {\n        var result = \"<ul>\";\n\n        if (editable === true) {\n            result += MENU_ITEMS.edit(messages);\n            result += MENU_ITEMS.create(messages);\n            result += MENU_ITEMS.destroy(messages);\n        } else {\n            if (editable.fields || editable.parent) {\n                result += MENU_ITEMS.edit(messages);\n            }\n            if (editable.create) {\n                result += MENU_ITEMS.create(messages);\n            }\n            if (editable.destroy) {\n                result += MENU_ITEMS.destroy(messages);\n            }\n        }\n\n        return result;\n    };\n\n    var GROUP_HEADER_TEMPLATE = ({ value, field }) => '<div>' +\n        `<div class=\"k-orgchart-node-group-title\">${encode(value)}</div>` +\n        `<div class=\"k-orgchart-node-group-subtitle\">${encode(field)}</div>` +\n    '</div>';\n\n    var AVATAR_PREVIEW_TEMPLATE = ({ avatar, name, destroy, fileName }) => '<div class=\"k-orgchart-avatar-preview k-hstack k-align-items-center k-pb-lg\">' +\n        '<div class=\"k-avatar k-avatar-solid-primary k-avatar-solid k-avatar-lg k-rounded-full\">' +\n            '<span class=\"k-avatar-image\">' +\n                `<img src=\"${encode(avatar)}\" alt=\"${encode(name)}\">` +\n            '</span>' +\n        '</div>' +\n        `<div class=\"k-px-md\">${encode(fileName)}</div>` +\n        kendo.html.renderButton(`<button aria-label=\"${encode(destroy)}\"></button>`, {\n            icon: 'trash',\n            fillMode: \"flat\"\n        }) +\n    '</div>';\n\n    var EDITOR_BUTTONS_TEMPLATE = ({ cancel, save }) => '<div class=\"k-edit-buttons\">' +\n        kendo.html.renderButton(`<button class=\"k-orgchart-update\">${encode(save)}</button>`, {\n                icon: \"save\",\n                themeColor: \"primary\"\n            }) +\n        kendo.html.renderButton(`<button class=\"k-orgchart-cancel\">${encode(cancel)}</button>`, {\n            icon: \"cancel-outline\"\n        }) +\n    '</div>';\n\n    var OrgChart = DataBoundWidget.extend({\n        init: function(element, options, events) {\n            if (isArray(options)) {\n                options = { dataSource: options };\n            }\n\n            options = options || {};\n\n            DataBoundWidget.fn.init.call(this, element, options);\n\n            if (events) {\n                this._events = events;\n            }\n\n            this._wrapper();\n            this._view();\n            this._dataSource();\n            this._contextMenu();\n\n            if (this.options.autoBind) {\n                this.dataSource.fetch();\n            }\n\n            kendo.notify(this);\n        },\n\n        options: {\n            name: \"OrgChart\",\n            autoBind: true,\n            cardsColors: null,\n            dataSource: {},\n            editable: {\n                create: true,\n                destroy: true,\n                fields: true,\n                form: {\n                    buttonsTemplate: () => \"\",\n                    orientation: \"vertical\"\n                },\n                parent: true\n            },\n            groupField: null,\n            groupHeaderTemplate: GROUP_HEADER_TEMPLATE,\n            template: null,\n            messages: {\n                label: \"Org Chart\",\n                edit: \"Edit\",\n                create: \"Create\",\n                destroy: \"Delete\",\n                destroyContent: \"Are you sure you want to delete this item and all its children?\",\n                destroyTitle: \"Delete item\",\n                cancel: \"Cancel\",\n                save: \"Save\",\n                menuLabel: \"Edit menu\",\n                uploadAvatar: \"Upload new avatar\",\n                parent: \"Parent\",\n                name: \"Name\",\n                title: \"Title\",\n                none: \"--None--\",\n                expand: \"expand\",\n                collapse: \"collapse\"\n            }\n        },\n\n        events: [\n            CANCEL,\n            CHANGE,\n            COLLAPSE,\n            CREATE,\n            DATABINDING,\n            DATABOUND,\n            DELETE,\n            EDIT,\n            EXPAND,\n            KENDOKEYDOWN,\n            SAVE,\n            SELECT\n         ],\n\n        destroy: function() {\n            if (this._menu) {\n                this._menu.destroy();\n            }\n            if (this._editWindow) {\n                this._editWindow.destroy();\n            }\n            if (this._confirmDestroy) {\n                this._confirmDestroy.destroy();\n            }\n\n            this.view.destroy();\n\n            DataBoundWidget.fn.destroy.call(this);\n            this.wrapper.off(NS);\n        },\n\n        setDataSource: function(dataSource) {\n            this.options.dataSource = dataSource;\n            this._dataSource();\n\n            if (this.options.autoBind) {\n                dataSource.fetch();\n            }\n        },\n\n        setOptions: function(options) {\n            var that = this;\n\n            DataBoundWidget.fn.setOptions.call(that, options);\n        },\n\n        append: function(item, parent) {\n            var that = this,\n                $parent = that.view.jqueryItemElement(parent),\n                parentItem = that.dataItem($parent);\n\n            if (!$parent || !parentItem) {\n                return;\n            }\n\n            if (!parentItem.loaded()) {\n                that.dataSource.read({ id: parentItem.id })\n                    .then(function() {\n                        that.dataSource.add(extend({}, item, { parentId: parentItem.id }));\n                        that.dataSource.sync();\n                    });\n            } else {\n                that.dataSource.add(extend({}, item, { parentId: parentItem.id }));\n                that.dataSource.sync();\n            }\n        },\n\n        cancelChanges: function() {\n            if (this.dataSource.hasChanges()) {\n                this.dataSource.cancelChanges();\n            }\n        },\n\n        collapse: function(item) {\n            return this.view.collapse(item);\n        },\n\n        dataItem: function(item) {\n            var $item = this.view.jqueryItemElement(item);\n\n            if (!$item || !$item.data(UID)) {\n                return;\n            }\n\n            return this.dataSource.getByUid($item.data(UID));\n        },\n\n        delete: function(item) {\n            var $item = this.view.jqueryItemElement(item);\n\n            if (!$item) {\n                return;\n            }\n\n            this.dataSource.remove(this.dataItem($item));\n            this.dataSource.sync();\n        },\n\n        edit: function(item) {\n            var $item = this.view.jqueryItemElement(item),\n                dataItem = this.dataItem($item);\n\n            if (!$item || !dataItem) {\n                return;\n            }\n\n            this._edit(dataItem);\n        },\n\n        expand: function(item) {\n            return this.view.expand(item);\n        },\n\n        getCollapsedNodes: function() {\n            return this.wrapper.find(\"[aria-expanded='false']\");\n        },\n\n        items: function() {\n            return this.wrapper.find(DOT + ORGCHART_STYLES.card);\n        },\n\n        parent: function(item) {\n            var $item = this.view.jqueryItemElement(item),\n                id;\n\n            if (!$item) {\n                return;\n            }\n\n            id = $item.closest(DOT + ORGCHART_STYLES.group).attr(ID);\n\n            return this.wrapper.find(\"[aria-owns='\" + id + \"']\");\n        },\n\n        saveChanges: function() {\n            this.dataSource.sync();\n        },\n\n        select: function(item) {\n            var $item = this.view._getToSelect(item);\n\n            if (!$item) {\n                return;\n            } else {\n                return this.view.select($item);\n            }\n        },\n\n        _avatarPreview: function(item, fileName) {\n            var form = this._form,\n                avatar = item.avatar,\n                avatarRemove = function() {\n                    formWrapper.find(DOT + ORGCHART_STYLES.avatarPreview).remove();\n                    item.set(\"avatar\", null);\n                },\n                formWrapper, data;\n\n            if (!form) {\n                return;\n            }\n\n            if (!fileName) {\n                fileName = avatar.split('\\\\').pop().split('/').pop();\n\n                if (!fileName || fileName.indexOf('.') == -1) {\n                    fileName = item.name;\n                }\n            }\n\n            data = {\n                name: item.name,\n                avatar: avatar,\n                fileName: fileName,\n                destroy: this.options.messages.destroy\n            };\n\n            formWrapper = form.wrapper;\n            formWrapper.find(DOT + ORGCHART_STYLES.avatarPreview).remove();\n\n            formWrapper.find('[type=\"file\"]').closest(DOT + \"k-form-field\").prepend(kendo.template(AVATAR_PREVIEW_TEMPLATE)(data));\n            formWrapper.find(DOT + ORGCHART_STYLES.avatarPreview + SPACE + DOT + \"k-button\").on(CLICK, avatarRemove);\n        },\n\n        _contextMenu: function() {\n            var options = this.options,\n                editable = options.editable,\n                messages = options.messages,\n                menuOptions = {\n                    target: this.wrapper,\n                    filter: DOT + ORGCHART_STYLES.cardMenu,\n                    select: this._onMenuItemClick.bind(this),\n                    activate: this._onMenuOpen.bind(this),\n                    deactivate: this._onMenuClose.bind(this),\n                    showOn: \"click\",\n                    animation: false\n                },\n                menuElement;\n\n            if (editable === true ||\n                (editable !== false &&\n                    (editable.create || editable.destroy || editable.fields || editable.parent))) {\n                        menuElement = MENU_TEMPLATE(messages, editable);\n\n                        this._menu = new ContextMenu(menuElement, menuOptions);\n                    }\n        },\n\n        _dataSource: function() {\n            var ds = this.dataSource,\n                dsOptions = this.options.dataSource;\n\n            if (ds) {\n                ds.unbind(CHANGE, this._dataSourceChangeHandler);\n                ds.unbind(ERROR, this._errorHandler);\n                ds.unbind(PROGRESS, this._progressHandler);\n                ds.unbind(REQUEST_START, this._requestStartHandler);\n            }\n\n            this._dataSourceChangeHandler = this._onDataSourceChange.bind(this);\n            this._errorHandler = this._onDataSourceError.bind(this);\n            this._progressHandler = this._progress.bind(this);\n            this._requestStartHandler = this._onDataSourceRequestStart.bind(this);\n\n            ds = this.dataSource = OrgChartDataSource.create(dsOptions);\n\n            ds.bind(CHANGE, this._dataSourceChangeHandler);\n            ds.bind(ERROR, this._errorHandler);\n            ds.bind(PROGRESS, this._progressHandler);\n            ds.bind(REQUEST_START, this._requestStartHandler);\n\n            this.view.dataSource = ds;\n        },\n\n        _destroyItem: function(item) {\n            var that = this,\n                el = $(\"<div></div>\"),\n                messages = that.options.messages,\n                restoreFocus = function() {\n                    that.wrapper\n                        .find(DOT + ORGCHART_STYLES.card + \"[tabindex=0]\" + COMMA + DOT + ORGCHART_STYLES.nodesGroup + \"[tabindex=0]\")\n                        .addClass(ORGCHART_STYLES.focused)\n                        .trigger(\"focus\");\n                },\n                confirm = this._confirmDestroy = new kendo.ui.Confirm(el, {\n                    title: messages.destroyTitle,\n                    content: messages.destroyContent,\n                    messages: {\n                      okText: messages.destroy,\n                      cancel: messages.cancel\n                    },\n                    show: function() {\n                        setTimeout(function() {\n                            confirm.element.trigger(\"focus\");\n                        });\n                    }\n                });\n\n            confirm.open();\n\n            confirm.result.done(function() {\n                if (!that.trigger(DELETE, { dataItem: item })) {\n                    that.dataSource.remove(item);\n                    that.dataSource.sync();\n                }\n\n                that.view._shouldRestoreSelection = true;\n                that.view._restoreSelection();\n            });\n\n            confirm.result.fail(restoreFocus);\n        },\n\n        _edit: function(dataItem) {\n            var that = this,\n                formElement = $(\"<div>\"),\n                windowElement = $(\"<div>\"),\n                messages = this.options.messages,\n                formOptions = this._formOptions(dataItem),\n                save;\n\n            if (!formOptions) {\n                return;\n            }\n\n            that._form = new kendo.ui.Form(formElement, formOptions);\n\n            if (!!dataItem.avatar) {\n                that._avatarPreview(dataItem);\n            }\n\n            windowElement.append(formElement);\n\n            that._editWindow = new kendo.ui.Window(windowElement, {\n                title: messages.edit,\n                width: \"380 px\",\n                modal: true,\n                close: function(e) {\n                    if (!save) {\n                        if (!that.trigger(CANCEL, { dataItem: dataItem })) {\n                            that.cancelChanges();\n                        } else {\n                            e.preventDefault();\n                        }\n                    } else {\n                        save = false;\n                    }\n                },\n                deactivate: function() {\n                    that._editWindow.wrapper.off(CLICK);\n                    that._editWindow.destroy();\n                    that._editWindow = null;\n                    that.view._restoreSelection();\n                }\n            });\n\n            windowElement.after(kendo.template(EDITOR_BUTTONS_TEMPLATE)({\n                save: messages.save,\n                cancel: messages.cancel\n            }));\n\n            that._editWindow.center().open();\n\n            that._editWindow.wrapper.on(CLICK, DOT + ORGCHART_STYLES.update, function() {\n                if (that._form.validate()) {\n                    save = true;\n\n                    if (!that.trigger(SAVE, { dataItem: dataItem })) {\n                        that._editWindow.close();\n                        that.saveChanges();\n                    }\n                }\n            });\n\n            that._editWindow.wrapper.on(CLICK, DOT + ORGCHART_STYLES.cancel, function() {\n                that._editWindow.close();\n            });\n        },\n\n        _formOptions: function(item) {\n            var options = this.options,\n                messages = options.messages,\n                optionsForm = options.editable.form,\n                items = [],\n                parentsDs, optionsItems;\n\n            if (optionsForm) {\n                optionsItems = optionsForm.items;\n            }\n\n            if ((!optionsItems || optionsItems.length === 0) &&\n                (options.editable === true || (options.editable && options.editable.parent))) {\n\n                parentsDs = [{\n                    id: null,\n                    name: messages.none\n                }].concat(this.dataSource.prospectParents(item));\n\n                items.push({\n                    field: \"parentId\",\n                    editor: \"DropDownList\",\n                    label: messages.parent,\n                    editorOptions: {\n                        dataSource: parentsDs,\n                        dataValueField: \"id\",\n                        dataTextField: \"name\",\n                        valuePrimitive: true\n                    }\n                });\n            }\n\n            if ((!optionsItems || optionsItems.length === 0) &&\n                (options.editable === true || (options.editable && options.editable.fields))) {\n\n                items = items.concat([{\n                    field: \"name\",\n                    label: messages.name,\n                    validation: { required: true }\n                }, {\n                    field: \"title\",\n                    label: messages.title\n                }, {\n                    field: \"avatar\",\n                    label: messages.uploadAvatar,\n                    editor: this._uploadEditor.bind(this, item)\n                }]);\n            }\n\n            if (optionsForm) {\n                delete optionsForm.formData;\n            }\n\n            if (items.length > 0 || (optionsItems && optionsItems.length > 0)) {\n                return extend(true, {}, {\n                    formData: item,\n                    items: items\n                }, optionsForm);\n            } else {\n                return false;\n            }\n        },\n\n        _onDataSourceChange: function(e) {\n            if (e.action === \"add\" || e.action === \"itemchange\" && this._editWindow) {\n                return;\n            }\n\n            if (!e.action || e.action === \"sync\") {\n                if (this.trigger(DATABINDING, e)) {\n                    this._progress(false);\n                    return;\n                }\n            }\n\n            this._progress(true);\n            this.view.refresh();\n\n            if (!e.action || e.action === \"sync\") {\n                this.trigger(DATABOUND);\n            }\n\n            this._progress(false);\n        },\n\n        _onDataSourceError: function() {\n            this._progress(false);\n        },\n\n        _onDataSourceRequestStart: function() {\n            this.view._cacheFocused();\n        },\n\n        _onMenuClose: function() {\n            if ($(document.activeElement).closest(\"[role='alertdialog']\").length === 0) {\n                this.wrapper.find(\"[tabindex='0']\")\n                    .addClass(ORGCHART_STYLES.focused)\n                    .trigger(\"focus\");\n            }\n        },\n\n        _onMenuItemClick: function(e) {\n            var that = this,\n                targetItem = $(e.target).closest(DOT + ORGCHART_STYLES.node).find(DOT + ORGCHART_STYLES.card),\n                dataItem = that.dataItem(targetItem),\n                action = $(e.item).data(ACTION),\n                newItem;\n\n            if (!dataItem) {\n                return;\n            }\n\n            if (action === EDIT) {\n                if (!that.trigger(EDIT, { dataItem: dataItem })) {\n                    that._edit(dataItem);\n                }\n            } else if (action === CREATE) {\n                if (!that.trigger(CREATE, { dataItem: dataItem })) {\n                    if (!dataItem.loaded()) {\n                        that.dataSource.read({ id: dataItem.id })\n                            .then(function() {\n                                newItem = that.dataSource.add({\n                                    parentId: dataItem.id\n                                });\n\n                                that._edit(newItem);\n                            });\n                    } else {\n                        newItem = that.dataSource.add({\n                            parentId: dataItem.id\n                        });\n\n                        that._edit(newItem);\n                    }\n                }\n            } else if (action === DESTROY) {\n                that._destroyItem(dataItem);\n            }\n        },\n\n        _onMenuOpen: function() {\n            this.view._cacheFocused();\n            this.wrapper.find(DOT + ORGCHART_STYLES.focused).removeClass(ORGCHART_STYLES.focused);\n            this._menu.element.find(DOT + ORGCHART_STYLES.menuItem).first().trigger(FOCUS);\n        },\n\n        _openMenu: function(focused) {\n            if (this._menu) {\n                this._menu.open(focused.find(DOT + ORGCHART_STYLES.cardMenu));\n            }\n        },\n\n        _progress: function(toggle) {\n            kendo.ui.progress(this.container, toggle);\n        },\n\n        _triggerCollapse: function(e) {\n            if (this.trigger(COLLAPSE, { item: e.item, dataItems: e.dataItems })) {\n                e.preventDefault();\n            }\n        },\n\n        _triggerExpand: function(e) {\n            if (this.trigger(EXPAND, { item: e.item, dataItems: e.dataItems })) {\n                e.preventDefault();\n            }\n        },\n\n        _triggerSelect: function(e) {\n            if (!this.trigger(SELECT, { item: e.item, dataItems: e.dataItems })) {\n                this.view.select(e.item);\n                this.trigger(CHANGE, { item: e.item, dataItems: e.dataItems });\n            }\n        },\n\n        _uploadEditor: function(item, container) {\n            var that = this;\n\n            $('<input type=\"file\">')\n                .appendTo(container)\n                .kendoUpload({\n                    async: false,\n                    multiple: false,\n                    select: function(e) {\n                        var fileInfo = e.files[0];\n                        var raw = fileInfo.rawFile;\n                        var reader = new FileReader();\n\n                        if (fileInfo.validationErrors && fileInfo.validationErrors.length > 0) {\n                            return;\n                        }\n\n                        if (raw) {\n                            reader.onloadend = function() {\n                                item.set(\"avatar\", this.result);\n                                that._avatarPreview(item, raw.name);\n                            };\n\n                          reader.readAsDataURL(raw);\n                        }\n                    },\n                    validation: {\n                        allowedExtensions: [\".gif\", \".jpg\", \".png\"],\n                        maxFileSize: 1048576\n                    }\n                });\n        },\n\n        _view: function() {\n            if (this.options.groupField !== null && this.options.groupField !== undefined$1) {\n                this.view = new kendo.orgChart.GroupedView(this.container, this.options);\n            } else {\n                this.view = new kendo.orgChart.SingleView(this.container, this.options);\n            }\n\n            this.view.bind(SELECT, this._triggerSelect.bind(this));\n            this.view.bind(EXPAND, this._triggerExpand.bind(this));\n            this.view.bind(COLLAPSE, this._triggerCollapse.bind(this));\n            this.view.bind(MENU, this._openMenu.bind(this));\n\n        },\n\n        _wrapper: function() {\n            var container = $(\"<div class='k-orgchart-container'>\");\n\n            this.wrapper = this.element;\n            this.container = container;\n\n            this.wrapper.addClass(ORGCHART_STYLES.wrapper);\n            this.wrapper.append(container);\n        }\n    });\n\n    kendo.ui.plugin(OrgChart);\n\n})(window.kendo.jQuery);\n"]}