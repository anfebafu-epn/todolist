<?php
/**
 * Generated by Haxe 4.2.2
 */

namespace nMorph\framework\orm\lang;

use \nMorph\framework\orm\common\ddl\DropViewClause;
use \php\Boot;
use \nMorph\framework\orm\interfaces\IColumnDefinition;
use \nMorph\framework\orm\configuration\DatabaseEngineEnum;
use \nMorph\framework\orm\client\QueryBlock;
use \nMorph\framework\orm\common\ddl\DropIndexClause;
use \nMorph\framework\orm\configuration\Configuration;
use \nMorph\framework\orm\interfaces\IClause;
use \nMorph\framework\orm\interfaces\ILang;
use \nMorph\framework\orm\common\ddl\CreateSql;
use \nMorph\framework\orm\common\sentences\FielIndexDefinitionSentences;
use \nMorph\framework\orm\common\ddl\AlterViewClause;
use \nMorph\framework\orm\common\ddl\AlterTableClause;
use \nMorph\framework\orm\common\ddl\DropTableClause;
use \nMorph\framework\orm\client\Connector;
use \nMorph\framework\orm\common\ddl\CreateViewClause;
use \nMorph\framework\orm\common\ddl\ExistClause;
use \nMorph\framework\orm\common\ddl\CreateTableClause;
use \nMorph\framework\orm\common\ddl\CreateIndexClause;

/**
 * ...
 * @author ...
 */
class DDL implements ILang {
	/**
	 * @var IClause[]|\Array_hx
	 */
	public $Clauses;
	/**
	 * @var string[]|\Array_hx
	 */
	public $GeneratedBlocks;
	/**
	 * @var QueryBlock[]|\Array_hx
	 */
	public $QueryBlocks;

	/**
	 * @param string $TableName
	 * 
	 * @return AlterTableClause
	 */
	public static function ALTERTABLE ($TableName) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:57: characters 3-34
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:58: characters 3-74
		$atc = new AlterTableClause($CurrentDDL, $TableName);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:59: characters 3-28
		$CurrentDDL->AddClause($atc);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:60: characters 3-13
		return $atc;
	}

	/**
	 * @return void
	 */
	public static function ALTERUSER () {
	}

	/**
	 * @param string $ViewName
	 * 
	 * @return AlterViewClause
	 */
	public static function ALTERVIEW ($ViewName) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:89: characters 3-34
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:90: characters 3-71
		$vav = new AlterViewClause($CurrentDDL, $ViewName);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:91: characters 3-28
		$CurrentDDL->AddClause($vav);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:92: characters 3-13
		return $vav;
	}

	/**
	 * @param string $IndexName
	 * @param FielIndexDefinitionSentences $Columns
	 * 
	 * @return CreateIndexClause
	 */
	public static function CREATEINDEX ($IndexName, $Columns) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:128: characters 3-34
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:129: characters 3-83
		$ci = new CreateIndexClause($CurrentDDL, $IndexName, $Columns);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:130: characters 3-27
		$CurrentDDL->AddClause($ci);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:131: characters 3-12
		return $ci;
	}

	/**
	 * @param string $TableName
	 * @param IColumnDefinition[]|\Array_hx $Columns
	 * 
	 * @return CreateTableClause
	 */
	public static function CREATETABLE ($TableName, $Columns) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:41: characters 3-34
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:42: characters 3-85
		$ctc = new CreateTableClause($CurrentDDL, $TableName, $Columns);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:43: characters 3-28
		$CurrentDDL->AddClause($ctc);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:44: characters 3-13
		return $ctc;
	}

	/**
	 * @return void
	 */
	public static function CREATEUSER () {
	}

	/**
	 * @param string $ViewName
	 * 
	 * @return CreateViewClause
	 */
	public static function CREATEVIEW ($ViewName) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:81: characters 3-34
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:82: characters 3-73
		$vtc = new CreateViewClause($CurrentDDL, $ViewName);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:83: characters 3-28
		$CurrentDDL->AddClause($vtc);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:84: characters 3-13
		return $vtc;
	}

	/**
	 * @param string $Querys
	 * 
	 * @return CreateSql
	 */
	public static function CREATEsql ($Querys) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:49: characters 3-34
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:50: characters 3-57
		$ctc = new CreateSql($CurrentDDL, $Querys);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:51: characters 3-28
		$CurrentDDL->AddClause($ctc);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:52: characters 3-13
		return $ctc;
	}

	/**
	 * @param string $IndexName
	 * @param string $TableName
	 * 
	 * @return DropIndexClause
	 */
	public static function DROPINDEX ($IndexName, $TableName = null) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:136: characters 3-34
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:137: characters 3-81
		$di = new DropIndexClause($CurrentDDL, $IndexName, $TableName);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:138: characters 3-27
		$CurrentDDL->AddClause($di);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:139: characters 3-12
		return $di;
	}

	/**
	 * @param string $TableName
	 * 
	 * @return DropTableClause
	 */
	public static function DROPTABLE ($TableName) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:73: characters 3-34
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:74: characters 3-72
		$dtc = new DropTableClause($CurrentDDL, $TableName);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:75: characters 3-28
		$CurrentDDL->AddClause($dtc);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:76: characters 3-13
		return $dtc;
	}

	/**
	 * @return void
	 */
	public static function DROPUSER () {
	}

	/**
	 * @param string $ViewName
	 * 
	 * @return DropViewClause
	 */
	public static function DROPVIEW ($ViewName) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:97: characters 3-34
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:98: characters 3-69
		$vav = new DropViewClause($CurrentDDL, $ViewName);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:99: characters 3-28
		$CurrentDDL->AddClause($vav);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:100: characters 3-13
		return $vav;
	}

	/**
	 * @param string $TableName
	 * 
	 * @return ExistClause
	 */
	public static function EXISTTABLE ($TableName) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:105: characters 3-33
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:106: characters 3-64
		$vav = new ExistClause($CurrentDDL, $TableName);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:107: characters 3-28
		$CurrentDDL->AddClause($vav);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:108: characters 3-13
		return $vav;
	}

	/**
	 * @return AlterTableClause
	 */
	public static function RENAMETABLE () {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:65: characters 3-34
		$CurrentDDL = new DDL();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:66: characters 3-63
		$dtc = new AlterTableClause($CurrentDDL);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:67: characters 3-28
		$CurrentDDL->AddClause($dtc);
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:68: characters 3-13
		return $dtc;
	}

	/**
	 * @return void
	 */
	public function __construct () {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:33: characters 47-66
		$this->GeneratedBlocks = new \Array_hx();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:32: characters 46-69
		$this->QueryBlocks = new \Array_hx();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:31: characters 39-59
		$this->Clauses = new \Array_hx();
	}

	/**
	 * @param string $Block
	 * 
	 * @return void
	 */
	public function AddBlock ($Block) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:153: characters 3-30
		$_this = $this->GeneratedBlocks;
		$_this->arr[$_this->length++] = $Block;
	}

	/**
	 * @param IClause $Clause
	 * 
	 * @return void
	 */
	public function AddClause ($Clause) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:144: characters 3-23
		$_this = $this->Clauses;
		$_this->arr[$_this->length++] = $Clause;
	}

	/**
	 * @param QueryBlock $b
	 * 
	 * @return void
	 */
	public function AddQueryBlock ($b) {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:149: characters 3-22
		$_this = $this->QueryBlocks;
		$_this->arr[$_this->length++] = $b;
	}

	/**
	 * @return mixed
	 */
	public function Execute () {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:245: characters 3-36
		$GeneratedSQL = $this->GenerateAll();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:246: characters 3-61
		$GeneratedSQL = \StringTools::replace($GeneratedSQL, ".**\x0A", ".");
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:247: characters 3-70
		$Parameters = new \Array_hx();
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:248: characters 3-53
		return Connector::Execute($GeneratedSQL, $Parameters);
	}

	/**
	 * @return string
	 */
	public function GenerateAll () {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:170: characters 11-29
		$__hx__switch = ($this->getCurrentEngine()->index);
		if ($__hx__switch === 0) {
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:212: characters 5-21
			$Script = "";
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:214: lines 214-218
			$_g = 0;
			$_g1 = $this->Clauses;
			while ($_g < $_g1->length) {
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:214: characters 10-16
				$clause = ($_g1->arr[$_g] ?? null);
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:214: lines 214-218
				++$_g;
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:216: characters 6-26
				$clause->SCRIPT_PART();
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:217: characters 6-20
				$this->AddBlock("\x0A");
			}
		} else if ($__hx__switch === 1) {
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:192: characters 5-21
			$Script = "";
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:194: lines 194-198
			$_g = 0;
			$_g1 = $this->Clauses;
			while ($_g < $_g1->length) {
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:194: characters 10-16
				$clause = ($_g1->arr[$_g] ?? null);
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:194: lines 194-198
				++$_g;
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:196: characters 6-26
				$clause->SCRIPT_PART();
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:197: characters 6-20
				$this->AddBlock("\x0A");
			}
		} else if ($__hx__switch === 2) {
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:182: characters 5-21
			$Script = "";
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:184: lines 184-188
			$_g = 0;
			$_g1 = $this->Clauses;
			while ($_g < $_g1->length) {
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:184: characters 10-16
				$clause = ($_g1->arr[$_g] ?? null);
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:184: lines 184-188
				++$_g;
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:186: characters 6-26
				$clause->SCRIPT_PART();
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:187: characters 6-20
				$this->AddBlock("\x0A");
			}
		} else if ($__hx__switch === 3) {
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:202: characters 5-21
			$Script = "";
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:204: lines 204-208
			$_g = 0;
			$_g1 = $this->Clauses;
			while ($_g < $_g1->length) {
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:204: characters 10-16
				$clause = ($_g1->arr[$_g] ?? null);
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:204: lines 204-208
				++$_g;
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:206: characters 6-26
				$clause->SCRIPT_PART();
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:207: characters 6-20
				$this->AddBlock("\x0A");
			}
		} else if ($__hx__switch === 4) {
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:174: lines 174-178
			$_g = 0;
			$_g1 = $this->Clauses;
			while ($_g < $_g1->length) {
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:174: characters 10-16
				$clause = ($_g1->arr[$_g] ?? null);
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:174: lines 174-178
				++$_g;
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:176: characters 6-26
				$clause->SCRIPT_PART();
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:177: characters 6-20
				$this->AddBlock("\x0A");
			}
		}
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:223: characters 3-24
		$FinalScript = "";
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:225: lines 225-238
		$_g = 0;
		$_g1 = $this->GeneratedBlocks;
		while ($_g < $_g1->length) {
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:225: characters 8-17
			$CodeBlock = ($_g1->arr[$_g] ?? null);
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:225: lines 225-238
			++$_g;
			#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:229: lines 229-237
			if (\StringTools::startsWith($CodeBlock, "{{")) {
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:230: characters 22-71
				$_this = $this->QueryBlocks;
				$result = [];
				$data = $_this->arr;
				$_g_current = 0;
				$_g_length = \count($data);
				$_g_data = $data;
				while ($_g_current < $_g_length) {
					$item = $_g_data[$_g_current++];
					if ($item->get_BlockName() === $CodeBlock) {
						$result[] = $item;
					}
				}
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:230: characters 5-72
				$BlockFound = \Array_hx::wrap($result);
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:231: lines 231-233
				if ($BlockFound->length > 0) {
					#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:232: characters 6-34
					$FinalScript = ($FinalScript??'null') . \Std::string(($BlockFound->arr[0] ?? null));
				}
			} else {
				#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:236: characters 5-29
				$FinalScript = ($FinalScript??'null') . ($CodeBlock??'null');
			}
		}
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:240: characters 3-21
		return $FinalScript;
	}

	/**
	 * @return void
	 */
	public function RemoveLastBlock () {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:159: characters 3-24
		$_this = $this->GeneratedBlocks;
		if ($_this->length > 0) {
			$_this->length--;
		}
		\array_pop($_this->arr);
	}

	/**
	 * @return DatabaseEngineEnum
	 */
	public function getCurrentEngine () {
		#5_framework\orm\src/nMorph/framework/orm/lang/DDL.hx:164: characters 3-75
		return Configuration::$Data->get_CurrentDatabaseConnection()->get_DatabaseEngine();
	}
}

Boot::registerClass(DDL::class, 'nMorph.framework.orm.lang.DDL');
